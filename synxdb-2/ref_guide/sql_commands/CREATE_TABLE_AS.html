<!DOCTYPE HTML>
<html lang="en" class="ayu sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>CREATE TABLE AS - SynxDB 2 Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">SynxDB 2 Documentation</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                        &nbsp;&nbsp;&nbsp;&nbsp;
                        <a href="https://www.synxdata.com/"><img id="fa fa-print" src="../../SYNX-Text-and-Circular-Logo-142x28-White-text-Black-background.png" alt="Synx Data Labs Logo"/></a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="create-table-as"><a class="header" href="#create-table-as">CREATE TABLE AS</a></h1>
<p>Defines a new table from the results of a query.</p>
<h2 id="synopsis"><a class="header" href="#synopsis"><a id="section2"></a>Synopsis</a></h2>
<pre><code class="language-{#sql_command_synopsis}">CREATE [ [ GLOBAL | LOCAL ] { TEMPORARY | TEMP } | UNLOGGED ] TABLE &lt;table_name&gt;
        [ (&lt;column_name&gt; [, ...] ) ]
        [ WITH ( &lt;storage_parameter&gt; [= &lt;value&gt;] [, ... ] ) | WITHOUT OIDS ]
        [ ON COMMIT { PRESERVE ROWS | DELETE ROWS | DROP } ]
        [ TABLESPACE &lt;tablespace_name&gt; ]
        AS &lt;query&gt;
        [ WITH [ NO ] DATA ]
        [ DISTRIBUTED BY (column [, ... ] ) | DISTRIBUTED RANDOMLY | DISTRIBUTED REPLICATED ]
      
</code></pre>
<p>where storage_parameter is:</p>
<pre><code>   appendoptimized={TRUE|FALSE}
   blocksize={8192-2097152}
   orientation={COLUMN|ROW}
   compresstype={ZLIB|ZSTD|RLE_TYPE|NONE}
   compresslevel={1-19 | 1}
   fillfactor={10-100}
   [oids=FALSE]
</code></pre>
<h2 id="description"><a class="header" href="#description"><a id="section3"></a>Description</a></h2>
<p><code>CREATE TABLE AS</code> creates a table and fills it with data computed by a <a href="SELECT.html">SELECT</a> command. The table columns have the names and data types associated with the output columns of the <code>SELECT</code>, however you can override the column names by giving an explicit list of new column names.</p>
<p><code>CREATE TABLE AS</code> creates a new table and evaluates the query just once to fill the new table initially. The new table will not track subsequent changes to the source tables of the query.</p>
<h2 id="parameters"><a class="header" href="#parameters"><a id="section4"></a>Parameters</a></h2>
<h3 id="global--local"><a class="header" href="#global--local">GLOBAL | LOCAL</a></h3>
<p>Ignored for compatibility. These keywords are deprecated; refer to <a href="CREATE_TABLE.html">CREATE TABLE</a> for details.</p>
<h3 id="temporary--temp"><a class="header" href="#temporary--temp">TEMPORARY | TEMP</a></h3>
<p>If specified, the new table is created as a temporary table. Temporary tables are automatically dropped at the end of a session, or optionally at the end of the current transaction (see <code>ON COMMIT</code>). Existing permanent tables with the same name are not visible to the current session while the temporary table exists, unless they are referenced with schema-qualified names. Any indexes created on a temporary table are automatically temporary as well.</p>
<h3 id="unlogged"><a class="header" href="#unlogged">UNLOGGED</a></h3>
<p>If specified, the table is created as an unlogged table. Data written to unlogged tables is not written to the write-ahead (WAL) log, which makes them considerably faster than ordinary tables. However, the contents of an unlogged table are not replicated to mirror segment instances. Also an unlogged table is not crash-safe. After a segment instance crash or unclean shutdown, the data for the unlogged table on that segment is truncated. Any indexes created on an unlogged table are automatically unlogged as well.</p>
<h3 id="table_name"><a class="header" href="#table_name">table_name</a></h3>
<p>The name (optionally schema-qualified) of the new table to be created.</p>
<h3 id="column_name"><a class="header" href="#column_name">column_name</a></h3>
<p>The name of a column in the new table. If column names are not provided, they are taken from the output column names of the query.</p>
<h3 id="with--storage_parametervalue-"><a class="header" href="#with--storage_parametervalue-">WITH ( storage_parameter=value )</a></h3>
<p>The <code>WITH</code> clause can be used to set storage options for the table or its indexes. Note that you can also set different storage parameters on a particular partition or subpartition by declaring the <code>WITH</code> clause in the partition specification. The following storage options are available:</p>
<p><strong>appendoptimized</strong> — Set to <code>TRUE</code> to create the table as an append-optimized table. If <code>FALSE</code> or not declared, the table will be created as a regular heap-storage table.</p>
<p><strong>blocksize</strong> — Set to the size, in bytes for each block in a table. The <code>blocksize</code> must be between 8192 and 2097152 bytes, and be a multiple of 8192. The default is 32768. The <code>blocksize</code> option is valid only if <code>appendoptimized=TRUE</code>.</p>
<p><strong>orientation</strong> — Set to <code>column</code> for column-oriented storage, or <code>row</code> (the default) for row-oriented storage. This option is only valid if <code>appendoptimized=TRUE</code>. Heap-storage tables can only be row-oriented.</p>
<p><strong>compresstype</strong> — Set to <code>ZLIB</code> (the default), <code>ZSTD</code>, or <code>RLE_TYPE</code> to specify the type of compression used. The value <code>NONE</code> deactivates compression. Zstd provides for both speed or a good compression ratio, tunable with the <code>compresslevel</code> option. zlib is provided for backwards-compatibility. Zstd outperforms these compression types on usual workloads. The <code>compresstype</code> option is valid only if <code>appendoptimized=TRUE</code>.</p>
<p>The value <code>RLE_TYPE</code>, which is supported only if <code>orientation</code>=<code>column</code> is specified, enables the run-length encoding (RLE) compression algorithm. RLE compresses data better than the Zstd or zlib compression algorithms when the same data value occurs in many consecutive rows.</p>
<p>For columns of type <code>BIGINT</code>, <code>INTEGER</code>, <code>DATE</code>, <code>TIME</code>, or <code>TIMESTAMP</code>, delta compression is also applied if the <code>compresstype</code> option is set to <code>RLE_TYPE</code> compression. The delta compression algorithm is based on the delta between column values in consecutive rows and is designed to improve compression when data is loaded in sorted order or the compression is applied to column data that is in sorted order.</p>
<p>For information about using table compression, see <a href="../../admin_guide/ddl/ddl-storage.html">Choosing the Table Storage Model</a> in the <em>SynxDB Administrator Guide</em>.</p>
<p><strong>compresslevel</strong> — For Zstd compression of append-optimized tables, set to an integer value from 1 (fastest compression) to 19 (highest compression ratio). For zlib compression, the valid range is from 1 to 9. If not declared, the default is 1. The <code>compresslevel</code> option is valid only if <code>appendoptimized=TRUE</code>.</p>
<p><strong>fillfactor</strong> — See <a href="CREATE_INDEX.html">CREATE INDEX</a> for more information about this index storage parameter.</p>
<p><strong>oids=FALSE</strong> — This setting is the default, and it ensures that rows do not have object identifiers assigned to them. SynxDB does not support using <code>WITH OIDS</code> or <code>oids=TRUE</code> to assign an OID system column.On large tables, such as those in a typical SynxDB system, using OIDs for table rows can cause wrap-around of the 32-bit OID counter. Once the counter wraps around, OIDs can no longer be assumed to be unique, which not only makes them useless to user applications, but can also cause problems in the SynxDB system catalog tables. In addition, excluding OIDs from a table reduces the space required to store the table on disk by 4 bytes per row, slightly improving performance. You cannot create OIDS on a partitioned or column-oriented table (an error is displayed). This syntax is deprecated and will be removed in a future SynxDB release.</p>
<h3 id="on-commit"><a class="header" href="#on-commit">ON COMMIT</a></h3>
<p>The behavior of temporary tables at the end of a transaction block can be controlled using <code>ON COMMIT</code>. The three options are:</p>
<p>PRESERVE ROWS — No special action is taken at the ends of transactions for temporary tables. This is the default behavior.</p>
<p>DELETE ROWS — All rows in the temporary table will be deleted at the end of each transaction block. Essentially, an automatic <code>TRUNCATE</code> is done at each commit.</p>
<p>DROP — The temporary table will be dropped at the end of the current transaction block.</p>
<h3 id="tablespace-tablespace_name"><a class="header" href="#tablespace-tablespace_name">TABLESPACE tablespace_name</a></h3>
<p>The tablespace_name parameter is the name of the tablespace in which the new table is to be created. If not specified, the database’s default tablespace is used, or <a href="../config_params/guc-list.html">temp_tablespaces</a> if the table is temporary.</p>
<h3 id="as-query"><a class="header" href="#as-query">AS query</a></h3>
<p>A <a href="SELECT.html">SELECT</a>, <a href="SELECT.html#table-command">TABLE</a>, or <a href="VALUES.html">VALUES</a> command, or an <a href="EXECUTE.html">EXECUTE</a> command that runs a prepared <code>SELECT</code> or <code>VALUES</code> query.</p>
<h3 id="distributed-by-column-opclass----distributed-randomlydistributed-replicated"><a class="header" href="#distributed-by-column-opclass----distributed-randomlydistributed-replicated">DISTRIBUTED BY ({column [opclass]}, [ … ] )<br/>DISTRIBUTED RANDOMLY<br/>DISTRIBUTED REPLICATED</a></h3>
<p>Used to declare the SynxDB distribution policy for the table. <code>DISTRIBUTED BY</code> uses hash distribution with one or more columns declared as the distribution key. For the most even data distribution, the distribution key should be the primary key of the table or a unique column (or set of columns). If that is not possible, then you may choose <code>DISTRIBUTED RANDOMLY</code>, which will send the data round-robin to the segment instances.</p>
<p><code>DISTRIBUTED REPLICATED</code> replicates all rows in the table to all SynxDB segments. It cannot be used with partitioned tables or with tables that inhert from other tables.</p>
<p>The SynxDB server configuration parameter <code>gp_create_table_random_default_distribution</code> controls the default table distribution policy if the DISTRIBUTED BY clause is not specified when you create a table. SynxDB follows these rules to create a table if a distribution policy is not specified.</p>
<ul>
<li>If the Postgres Planner creates the table, and the value of the parameter is <code>off</code>, the table distribution policy is determined based on the command.</li>
<li>If the Postgres Planner creates the table, and the value of the parameter is <code>on</code>, the table distribution policy is random.</li>
<li>If GPORCA creates the table, the table distribution policy is random. The parameter value has no effect.</li>
</ul>
<p>For more information about setting the default table distribution policy, see <a href="../config_params/guc-list.html"><code>gp_create_table_random_default_distribution</code></a>. For information about the Postgres Planner and GPORCA, see <a href="../../admin_guide/query/topics/query.html">Querying Data</a> in the <em>SynxDB Administrator Guide</em>.</p>
<h2 id="notes"><a class="header" href="#notes"><a id="section5"></a>Notes</a></h2>
<p>This command is functionally similar to <a href="SELECT_INTO.html">SELECT INTO</a>, but it is preferred since it is less likely to be confused with other uses of the <code>SELECT INTO</code> syntax. Furthermore, <code>CREATE TABLE AS</code> offers a superset of the functionality offered by <code>SELECT INTO</code>.</p>
<p><code>CREATE TABLE AS</code> can be used for fast data loading from external table data sources. See <a href="CREATE_EXTERNAL_TABLE.html">CREATE EXTERNAL TABLE</a>.</p>
<h2 id="examples"><a class="header" href="#examples"><a id="section6"></a>Examples</a></h2>
<p>Create a new table <code>films_recent</code> consisting of only recent entries from the table <code>films</code>:</p>
<pre><code>CREATE TABLE films_recent AS SELECT * FROM films WHERE 
date_prod &gt;= '2007-01-01';
</code></pre>
<p>Create a new temporary table <code>films_recent</code>, consisting of only recent entries from the table films, using a prepared statement. The new table will be dropped at commit:</p>
<pre><code>PREPARE recentfilms(date) AS SELECT * FROM films WHERE 
date_prod &gt; $1;
CREATE TEMP TABLE films_recent ON COMMIT DROP AS 
EXECUTE recentfilms('2007-01-01');
</code></pre>
<h2 id="compatibility"><a class="header" href="#compatibility"><a id="section7"></a>Compatibility</a></h2>
<p><code>CREATE TABLE AS</code> conforms to the SQL standard, with the following exceptions:</p>
<ul>
<li>The standard requires parentheses around the subquery clause; in SynxDB, these parentheses are optional.</li>
<li>The standard defines a <code>WITH [NO] DATA</code> clause; this is not currently implemented by SynxDB. The behavior provided by SynxDB is equivalent to the standard’s <code>WITH DATA</code> case. <code>WITH NO DATA</code> can be simulated by appending <code>LIMIT 0</code> to the query.</li>
<li>SynxDB handles temporary tables differently from the standard; see <code>CREATE TABLE</code> for details.</li>
<li>The <code>WITH</code> clause is a SynxDB extension; neither storage parameters nor <code>OIDs</code> are in the standard. The syntax for creating OID system columns is deprecated and will be removed in a future SynxDB release.</li>
<li>The SynxDB concept of tablespaces is not part of the standard. The <code>TABLESPACE</code> clause is an extension.</li>
</ul>
<h2 id="see-also"><a class="header" href="#see-also"><a id="section8"></a>See Also</a></h2>
<p><a href="CREATE_EXTERNAL_TABLE.html">CREATE EXTERNAL TABLE</a>, <a href="CREATE_EXTERNAL_TABLE.html">CREATE EXTERNAL TABLE</a>, <a href="EXECUTE.html">EXECUTE</a>, <a href="SELECT.html">SELECT</a>, <a href="SELECT_INTO.html">SELECT INTO</a>, <a href="VALUES.html">VALUES</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../ref_guide/sql_commands/CREATE_TABLE.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../ref_guide/sql_commands/CREATE_TABLESPACE.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../ref_guide/sql_commands/CREATE_TABLE.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../ref_guide/sql_commands/CREATE_TABLESPACE.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
