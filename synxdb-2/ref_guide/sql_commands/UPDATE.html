<!DOCTYPE HTML>
<html lang="en" class="ayu sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>UPDATE - SynxDB 2 Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">SynxDB 2 Documentation</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                        &nbsp;&nbsp;&nbsp;&nbsp;
                        <a href="https://www.synxdata.com/"><img id="fa fa-print" src="../../SYNX-Text-and-Circular-Logo-142x28-White-text-Black-background.png" alt="Synx Data Labs Logo"/></a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="update"><a class="header" href="#update">UPDATE</a></h1>
<p>Updates rows of a table.</p>
<h2 id="synopsis"><a class="header" href="#synopsis"><a id="section2"></a>Synopsis</a></h2>
<pre><code class="language-{#sql_command_synopsis}">[ WITH [ RECURSIVE ] &lt;with_query&gt; [, ...] ]
UPDATE [ONLY] &lt;table&gt; [[AS] &lt;alias&gt;]
   SET {&lt;column&gt; = {&lt;expression&gt; | DEFAULT} |
   (&lt;column&gt; [, ...]) = ({&lt;expression&gt; | DEFAULT} [, ...])} [, ...]
   [FROM &lt;fromlist&gt;]
   [WHERE &lt;condition &gt;| WHERE CURRENT OF &lt;cursor_name&gt; ]
</code></pre>
<h2 id="description"><a class="header" href="#description"><a id="section3"></a>Description</a></h2>
<p><code>UPDATE</code> changes the values of the specified columns in all rows that satisfy the condition. Only the columns to be modified need be mentioned in the <code>SET</code> clause; columns not explicitly modified retain their previous values.</p>
<p>By default, <code>UPDATE</code> will update rows in the specified table and all its subtables. If you wish to only update the specific table mentioned, you must use the <code>ONLY</code> clause.</p>
<p>There are two ways to modify a table using information contained in other tables in the database: using sub-selects, or specifying additional tables in the <code>FROM</code> clause. Which technique is more appropriate depends on the specific circumstances.</p>
<p>If the <code>WHERE CURRENT OF</code> clause is specified, the row that is updated is the one most recently fetched from the specified cursor.</p>
<p>The <code>WHERE CURRENT OF</code> clause is not supported with replicated tables.</p>
<p>You must have the <code>UPDATE</code> privilege on the table, or at least on the column(s) that are listed to be updated. You must also have the <code>SELECT</code> privilege on any column whose values are read in the expressions or condition.</p>
<blockquote>
<p><strong>Note</strong> As the default, SynxDB acquires an <code>EXCLUSIVE</code> lock on tables for <code>UPDATE</code> operations on heap tables. When the Global Deadlock Detector is enabled, the lock mode for <code>UPDATE</code> operations on heap tables is <code>ROW EXCLUSIVE</code>. See <a href="../../admin_guide/dml.html#topic_gdd">Global Deadlock Detector</a>.</p>
</blockquote>
<p><strong>Outputs</strong></p>
<p>On successful completion, an <code>UPDATE</code> command returns a command tag of the form:</p>
<pre><code>UPDATE &lt;count&gt;
</code></pre>
<p>where count is the number of rows updated. If count is 0, no rows matched the condition (this is not considered an error).</p>
<h2 id="parameters"><a class="header" href="#parameters"><a id="section5"></a>Parameters</a></h2>
<h3 id="with_query"><a class="header" href="#with_query">with_query</a></h3>
<p>The <code>WITH</code> clause allows you to specify one or more subqueries that can be referenced by name in the <code>UPDATE</code> query.</p>
<p>For an <code>UPDATE</code> command that includes a <code>WITH</code> clause, the clause can only contain <code>SELECT</code> commands, the <code>WITH</code> clause cannot contain a data-modifying command (<code>INSERT</code>, <code>UPDATE</code>, or <code>DELETE</code>).</p>
<p>It is possible for the query (<code>SELECT</code> statement) to also contain a <code>WITH</code> clause. In such a case both sets of with_query can be referenced within the <code>UPDATE</code> query, but the second one takes precedence since it is more closely nested.</p>
<p>See <a href="../../admin_guide/query/topics/CTE-query.html">WITH Queries (Common Table Expressions)</a> and <a href="SELECT.html">SELECT</a> for details.</p>
<h3 id="only"><a class="header" href="#only">ONLY</a></h3>
<p>If specified, update rows from the named table only. When not specified, any tables inheriting from the named table are also processed.</p>
<h3 id="table"><a class="header" href="#table">table</a></h3>
<p>The name (optionally schema-qualified) of an existing table.</p>
<h3 id="alias"><a class="header" href="#alias">alias</a></h3>
<p>A substitute name for the target table. When an alias is provided, it completely hides the actual name of the table. For example, given <code>UPDATE foo AS f</code>, the remainder of the <code>UPDATE</code> statement must refer to this table as <code>f</code> not <code>foo</code>.</p>
<h3 id="column"><a class="header" href="#column">column</a></h3>
<p>The name of a column in table. The column name can be qualified with a subfield name or array subscript, if needed. Do not include the table’s name in the specification of a target column.</p>
<h3 id="expression"><a class="header" href="#expression">expression</a></h3>
<p>An expression to assign to the column. The expression may use the old values of this and other columns in the table.</p>
<h3 id="default"><a class="header" href="#default">DEFAULT</a></h3>
<p>Set the column to its default value (which will be NULL if no specific default expression has been assigned to it).</p>
<h3 id="fromlist"><a class="header" href="#fromlist">fromlist</a></h3>
<p>A list of table expressions, allowing columns from other tables to appear in the <code>WHERE</code> condition and the update expressions. This is similar to the list of tables that can be specified in the <code>FROM</code> clause of a <code>SELECT</code> statement. Note that the target table must not appear in the fromlist, unless you intend a self-join (in which case it must appear with an alias in the fromlist).</p>
<h3 id="condition"><a class="header" href="#condition">condition</a></h3>
<p>An expression that returns a value of type boolean. Only rows for which this expression returns true will be updated.</p>
<h3 id="cursor_name"><a class="header" href="#cursor_name">cursor_name</a></h3>
<p>The name of the cursor to use in a <code>WHERE CURRENT OF</code> condition. The row to be updated is the one most recently fetched from the cursor. The cursor must be a non-grouping query on the <code>UPDATE</code> command target table. See <a href="DECLARE.html">DECLARE</a> for more information about creating cursors.</p>
<p><code>WHERE CURRENT OF</code> cannot be specified together with a Boolean condition.</p>
<p>Note that <code>WHERE CURRENT OF</code> cannot be specified together with a Boolean condition. The <code>UPDATE...WHERE CURRENT OF</code> statement can only be run on the server, for example in an interactive psql session or a script. Language extensions such as PL/pgSQL do not have support for updatable cursors.</p>
<p>See <a href="DECLARE.html">DECLARE</a> for more information about creating cursors.</p>
<h3 id="output_expression"><a class="header" href="#output_expression">output_expression</a></h3>
<p>An expression to be computed and returned by the <code>UPDATE</code> command after each row is updated. The expression may use any column names of the table or table(s) listed in <code>FROM</code>. Write <code>*</code> to return all columns.</p>
<h3 id="output_name"><a class="header" href="#output_name">output_name</a></h3>
<p>A name to use for a returned column.</p>
<h2 id="notes"><a class="header" href="#notes"><a id="section6"></a>Notes</a></h2>
<p><code>SET</code> is not allowed on the SynxDB distribution key columns of a table.</p>
<p>When a <code>FROM</code> clause is present, what essentially happens is that the target table is joined to the tables mentioned in the from list, and each output row of the join represents an update operation for the target table. When using <code>FROM</code> you should ensure that the join produces at most one output row for each row to be modified. In other words, a target row should not join to more than one row from the other table(s). If it does, then only one of the join rows will be used to update the target row, but which one will be used is not readily predictable.</p>
<p>Because of this indeterminacy, referencing other tables only within sub-selects is safer, though often harder to read and slower than using a join.</p>
<p>Running <code>UPDATE</code> and <code>DELETE</code> commands directly on a specific partition (child table) of a partitioned table is not supported. Instead, run these commands on the root partitioned table, the table created with the <code>CREATE TABLE</code> command.</p>
<p>For a partitioned table, all the child tables are locked during the <code>UPDATE</code> operation when the Global Deadlock Detector is not enabled (the default). Only some of the leaf child tables are locked when the Global Deadlock Detector is enabled. For information about the Global Deadlock Detector, see <a href="../../admin_guide/dml.html#topic_gdd">Global Deadlock Detector</a>.</p>
<h2 id="examples"><a class="header" href="#examples"><a id="section7"></a>Examples</a></h2>
<p>Change the word <code>Drama</code> to <code>Dramatic</code> in the column <code>kind</code> of the table <code>films</code>:</p>
<pre><code>UPDATE films SET kind = 'Dramatic' WHERE kind = 'Drama';
</code></pre>
<p>Adjust temperature entries and reset precipitation to its default value in one row of the table <code>weather</code>:</p>
<pre><code>UPDATE weather SET temp_lo = temp_lo+1, temp_hi = 
temp_lo+15, prcp = DEFAULT
WHERE city = 'San Francisco' AND date = '2016-07-03';
</code></pre>
<p>Use the alternative column-list syntax to do the same update:</p>
<pre><code>UPDATE weather SET (temp_lo, temp_hi, prcp) = (temp_lo+1, 
temp_lo+15, DEFAULT)
WHERE city = 'San Francisco' AND date = '2016-07-03';
</code></pre>
<p>Increment the sales count of the salesperson who manages the account for Acme Corporation, using the <code>FROM</code> clause syntax (assuming both tables being joined are distributed in SynxDB on the <code>id</code> column):</p>
<pre><code>UPDATE employees SET sales_count = sales_count + 1 FROM 
accounts
WHERE accounts.name = 'Acme Corporation'
AND employees.id = accounts.id;
</code></pre>
<p>Perform the same operation, using a sub-select in the <code>WHERE</code> clause:</p>
<pre><code>UPDATE employees SET sales_count = sales_count + 1 WHERE id =
  (SELECT id FROM accounts WHERE name = 'Acme Corporation');
</code></pre>
<p>Attempt to insert a new stock item along with the quantity of stock. If the item already exists, instead update the stock count of the existing item. To do this without failing the entire transaction, use savepoints.</p>
<pre><code>BEGIN;
-- other operations
SAVEPOINT sp1;
INSERT INTO wines VALUES('Chateau Lafite 2003', '24');
-- Assume the above fails because of a unique key violation,
-- so now we issue these commands:
ROLLBACK TO sp1;
UPDATE wines SET stock = stock + 24 WHERE winename = 'Chateau 
Lafite 2003';
-- continue with other operations, and eventually
COMMIT;
</code></pre>
<h2 id="compatibility"><a class="header" href="#compatibility"><a id="section8"></a>Compatibility</a></h2>
<p>This command conforms to the SQL standard, except that the <code>FROM</code> clause is a SynxDB extension.</p>
<p>According to the standard, the column-list syntax should allow a list of columns to be assigned from a single row-valued expression, such as a sub-select:</p>
<pre><code>UPDATE accounts SET (contact_last_name, contact_first_name) =
    (SELECT last_name, first_name FROM salesmen
     WHERE salesmen.id = accounts.sales_id);
</code></pre>
<p>This is not currently implemented — the source must be a list of independent expressions.</p>
<p>Some other database systems offer a <code>FROM</code> option in which the target table is supposed to be listed again within <code>FROM</code>. That is not how SynxDB interprets <code>FROM</code>. Be careful when porting applications that use this extension.</p>
<h2 id="see-also"><a class="header" href="#see-also"><a id="section9"></a>See Also</a></h2>
<p><a href="DECLARE.html">DECLARE</a>, <a href="DELETE.html">DELETE</a>, <a href="SELECT.html">SELECT</a>, <a href="INSERT.html">INSERT</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../ref_guide/sql_commands/UNLISTEN.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../ref_guide/sql_commands/VACUUM.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../ref_guide/sql_commands/UNLISTEN.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../ref_guide/sql_commands/VACUUM.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
