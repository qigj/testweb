<!DOCTYPE HTML>
<html lang="en" class="ayu sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>CREATE RESOURCE GROUP - SynxDB 2 Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">SynxDB 2 Documentation</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                        &nbsp;&nbsp;&nbsp;&nbsp;
                        <a href="https://www.synxdata.com/"><img id="fa fa-print" src="../../SYNX-Text-and-Circular-Logo-142x28-White-text-Black-background.png" alt="Synx Data Labs Logo"/></a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="create-resource-group"><a class="header" href="#create-resource-group">CREATE RESOURCE GROUP</a></h1>
<p>Defines a new resource group.</p>
<h2 id="synopsis"><a class="header" href="#synopsis"><a id="section2"></a>Synopsis</a></h2>
<pre><code class="language-{#sql_command_synopsis}">CREATE RESOURCE GROUP &lt;name&gt; WITH (&lt;group_attribute&gt;=&lt;value&gt; [, ... ])
</code></pre>
<p>where group_attribute is:</p>
<pre><code>CPU_RATE_LIMIT=&lt;integer&gt; | CPUSET=&lt;master_cores&gt;;&lt;segment_cores&gt;
[ MEMORY_LIMIT=&lt;integer&gt; ]
[ CONCURRENCY=&lt;integer&gt; ]
[ MEMORY_SHARED_QUOTA=&lt;integer&gt; ]
[ MEMORY_SPILL_RATIO=&lt;integer&gt; ]
[ MEMORY_AUDITOR= {vmtracker | cgroup} ]
</code></pre>
<h2 id="description"><a class="header" href="#description"><a id="section3"></a>Description</a></h2>
<p>Creates a new resource group for SynxDB resource management. You can create resource groups to manage resources for roles or to manage the resources of a SynxDB external component such as PL/Container.</p>
<p>A resource group that you create to manage a user role identifies concurrent transaction, memory, and CPU limits for the role when resource groups are enabled. You may assign such resource groups to one or more roles.</p>
<p>A resource group that you create to manage the resources of a SynxDB external component such as PL/Container identifies the memory and CPU limits for the component when resource groups are enabled. These resource groups use cgroups for both CPU and memory management. Assignment of resource groups to external components is component-specific. For example, you assign a PL/Container resource group when you configure a PL/Container runtime. You cannot assign a resource group that you create for external components to a role, nor can you assign a resource group that you create for roles to an external component.</p>
<p>You must have <code>SUPERUSER</code> privileges to create a resource group. The maximum number of resource groups allowed in your SynxDB cluster is 100.</p>
<p>SynxDB pre-defines two default resource groups: <code>admin_group</code> and <code>default_group</code>. These group names, as well as the group name <code>none</code>, are reserved.</p>
<p>To set appropriate limits for resource groups, the SynxDB administrator must be familiar with the queries typically run on the system, as well as the users/roles running those queries and the external components they may be using, such as PL/Containers.</p>
<p>After creating a resource group for a role, assign the group to one or more roles using the <a href="ALTER_ROLE.html">ALTER ROLE</a> or <a href="CREATE_ROLE.html">CREATE ROLE</a> commands.</p>
<p>After you create a resource group to manage the CPU and memory resources of an external component, configure the external component to use the resource group. For example, configure the PL/Container runtime <code>resource_group_id</code>.</p>
<h2 id="parameters"><a class="header" href="#parameters"><a id="section4"></a>Parameters</a></h2>
<h3 id="name"><a class="header" href="#name">name</a></h3>
<p>The name of the resource group.</p>
<h3 id="concurrency-integer"><a class="header" href="#concurrency-integer">CONCURRENCY integer</a></h3>
<p>The maximum number of concurrent transactions, including active and idle transactions, that are permitted for this resource group. The <code>CONCURRENCY</code> value must be an integer in the range [0 .. <code>max_connections</code>]. The default <code>CONCURRENCY</code> value for resource groups defined for roles is 20.</p>
<p>You must set <code>CONCURRENCY</code> to zero (0) for resource groups that you create for external components.</p>
<blockquote>
<p><strong>Note</strong> You cannot set the <code>CONCURRENCY</code> value for the <code>admin_group</code> to zero (0).</p>
</blockquote>
<h3 id="cpu_rate_limit-integercpuset-master_coressegment_cores"><a class="header" href="#cpu_rate_limit-integercpuset-master_coressegment_cores">CPU_RATE_LIMIT integer<br/>CPUSET &lt;master_cores&gt;;&lt;segment_cores&gt;</a></h3>
<p>Required. You must specify only one of <code>CPU_RATE_LIMIT</code> or <code>CPUSET</code> when you create a resource group.</p>
<p><code>CPU_RATE_LIMIT</code> is the percentage of CPU resources to allocate to this resource group. The minimum CPU percentage you can specify for a resource group is 1. The maximum is 100. The sum of the <code>CPU_RATE_LIMIT</code> values specified for all resource groups defined in the SynxDB cluster must be less than or equal to 100.</p>
<p><code>CPUSET</code> identifies the CPU cores to reserve for this resource group on the master host and on segment hosts. The CPU cores that you specify must be available in the system and cannot overlap with any CPU cores that you specify for other resource groups.</p>
<p>Specify cores as a comma-separated list of single core numbers or core number intervals. Define the master host cores first, followed by segment host cores, and separate the two with a semicolon. You must enclose the full core configuration in single quotes. For example, ‘1;1,3-4’ configures core 1 for the master host, and cores 1, 3, and 4 for the segment hosts.</p>
<blockquote>
<p><strong>Note</strong> You can configure <code>CPUSET</code> for a resource group only after you have enabled resource group-based resource management for your SynxDB cluster.</p>
</blockquote>
<h3 id="memory_limit-integer"><a class="header" href="#memory_limit-integer">MEMORY_LIMIT integer</a></h3>
<p>The total percentage of SynxDB memory resources to reserve for this resource group. The minimum memory percentage you can specify for a resource group is 0. The maximum is 100. The default value is 0.</p>
<p>When you specify a <code>MEMORY_LIMIT</code> of 0, SynxDB reserves no memory for the resource group, but uses global shared memory to fulfill all memory requests in the group. If <code>MEMORY_LIMIT</code> is 0, <code>MEMORY_SPILL_RATIO</code> must also be 0.</p>
<p>The sum of the <code>MEMORY_LIMIT</code> values specified for all resource groups defined in the SynxDB cluster must be less than or equal to 100.</p>
<h3 id="memory_shared_quota-integer"><a class="header" href="#memory_shared_quota-integer">MEMORY_SHARED_QUOTA integer</a></h3>
<p>The quota of shared memory in the resource group. Resource groups with a <code>MEMORY_SHARED_QUOTA</code> threshold set aside a percentage of memory allotted to the resource group to share across transactions. This shared memory is allocated on a first-come, first-served basis as available. A transaction may use none, some, or all of this memory. The minimum memory shared quota percentage you can specify for a resource group is 0. The maximum is 100. The default <code>MEMORY_SHARED_QUOTA</code> value is 80.</p>
<h3 id="memory_spill_ratio-integer"><a class="header" href="#memory_spill_ratio-integer">MEMORY_SPILL_RATIO integer</a></h3>
<p>The memory usage threshold for memory-intensive operators in a transaction. When this threshold is reached, a transaction spills to disk. You can specify an integer percentage value from 0 to 100 inclusive. The default <code>MEMORY_SPILL_RATIO</code> value is 0. When <code>MEMORY_SPILL_RATIO</code> is 0, SynxDB uses the <a href="../config_params/guc-list.html"><code>statement_mem</code></a> server configuration parameter value to control initial query operator memory.</p>
<h3 id="memory_auditor-vmtracker--cgroup"><a class="header" href="#memory_auditor-vmtracker--cgroup">MEMORY_AUDITOR {vmtracker | cgroup}</a></h3>
<p>The memory auditor for the resource group. SynxDB employs virtual memory tracking for role resources and cgroup memory tracking for resources used by external components. The default <code>MEMORY_AUDITOR</code> is <code>vmtracker</code>. When you create a resource group with <code>vmtracker</code> memory auditing, SynxDB tracks that resource group’s memory internally.</p>
<p>When you create a resource group specifying the <code>cgroup</code> <code>MEMORY_AUDITOR</code>, SynxDB defers the accounting of memory used by that resource group to cgroups. <code>CONCURRENCY</code> must be zero (0) for a resource group that you create for external components such as PL/Container. You cannot assign a resource group that you create for external components to a SynxDB role.</p>
<h2 id="notes"><a class="header" href="#notes"><a id="section5"></a>Notes</a></h2>
<p>You cannot submit a <code>CREATE RESOURCE GROUP</code> command in an explicit transaction or sub-transaction.</p>
<p>Use the <code>gp_toolkit.gp_resgroup_config</code> system view to display the limit settings of all resource groups:</p>
<pre><code>SELECT * FROM gp_toolkit.gp_resgroup_config;
</code></pre>
<h2 id="examples"><a class="header" href="#examples"><a id="section6"></a>Examples</a></h2>
<p>Create a resource group with CPU and memory limit percentages of 35:</p>
<pre><code>CREATE RESOURCE GROUP rgroup1 WITH (CPU_RATE_LIMIT=35, MEMORY_LIMIT=35);
</code></pre>
<p>Create a resource group with a concurrent transaction limit of 20, a memory limit of 15, and a CPU limit of 25:</p>
<pre><code>CREATE RESOURCE GROUP rgroup2 WITH (CONCURRENCY=20, 
  MEMORY_LIMIT=15, CPU_RATE_LIMIT=25);
</code></pre>
<p>Create a resource group to manage PL/Container resources specifying a memory limit of 10, and a CPU limit of 10:</p>
<pre><code>CREATE RESOURCE GROUP plc_run1 WITH (MEMORY_LIMIT=10, CPU_RATE_LIMIT=10,
  CONCURRENCY=0, MEMORY_AUDITOR=cgroup);
</code></pre>
<p>Create a resource group with a memory limit percentage of 11 to which you assign CPU core 1 on the master host, and cores 1 to 3 on segment hosts:</p>
<pre><code>CREATE RESOURCE GROUP rgroup3 WITH (CPUSET='1;1-3', MEMORY_LIMIT=11);
</code></pre>
<h2 id="compatibility"><a class="header" href="#compatibility"><a id="section7"></a>Compatibility</a></h2>
<p><code>CREATE RESOURCE GROUP</code> is a SynxDB extension. There is no provision for resource groups or resource management in the SQL standard.</p>
<h2 id="see-also"><a class="header" href="#see-also"><a id="section8"></a>See Also</a></h2>
<p><a href="ALTER_ROLE.html">ALTER ROLE</a>, <a href="CREATE_ROLE.html">CREATE ROLE</a>, <a href="ALTER_RESOURCE_GROUP.html">ALTER RESOURCE GROUP</a>, <a href="DROP_RESOURCE_GROUP.html">DROP RESOURCE GROUP</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../ref_guide/sql_commands/CREATE_PROTOCOL.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../ref_guide/sql_commands/CREATE_RESOURCE_QUEUE.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../ref_guide/sql_commands/CREATE_PROTOCOL.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../ref_guide/sql_commands/CREATE_RESOURCE_QUEUE.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
