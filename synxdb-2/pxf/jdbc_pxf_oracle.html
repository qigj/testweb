<!DOCTYPE HTML>
<html lang="en" class="ayu sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Example: Reading From and Writing to an Oracle Table - SynxDB 2 Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">SynxDB 2 Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                        &nbsp;&nbsp;&nbsp;&nbsp;
                        <a href="https://www.synxdata.com/"><img id="fa fa-print" src="../SYNX-Text-and-Circular-Logo-142x28-White-text-Black-background.png" alt="Synx Data Labs Logo"/></a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="example-reading-from-and-writing-to-an-oracle-table"><a class="header" href="#example-reading-from-and-writing-to-an-oracle-table">‘Example: Reading From and Writing to an Oracle Table’</a></h1>
<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<p>In this example, you:</p>
<ul>
<li>Create an Oracle user and assign all privileges on the table to the user</li>
<li>Create an Oracle table, and insert data into the table</li>
<li>Configure the PXF JDBC connector to access the Oracle database</li>
<li>Create a PXF readable external table that references the Oracle table</li>
<li>Read the data in the Oracle table using PXF</li>
<li>Create a PXF writable external table that references the Oracle table</li>
<li>Write data to the Oracle table using PXF</li>
<li>Read the data in the Oracle table again</li>
</ul>
<p>For information about controlling parallel execution in Oracle, refer to <a href="#parallel">About Setting Parallel Query Session Parameters</a> located at the end of this topic.</p>
<h2 id="create-an-oracle-table"><a class="header" href="#create-an-oracle-table"><a id="ex_create_pgtbl"></a>Create an Oracle Table</a></h2>
<p>Perform the following steps to create an Oracle table named <code>countries</code> in the schema <code>oracleuser</code>, and grant a user named <code>oracleuser</code> all the necessary privileges:</p>
<ol>
<li>
<p>Identify the host name and port of your Oracle server.</p>
</li>
<li>
<p>Connect to the Oracle database as the <code>system</code> user:</p>
<pre><code class="language-shell">$ sqlplus system
</code></pre>
</li>
<li>
<p>Create a user named <code>oracleuser</code> and assign the password <code>mypassword</code> to it:</p>
<pre><code class="language-sql">&gt; CREATE USER oracleuser IDENTIFIED BY mypassword;
</code></pre>
</li>
<li>
<p>Assign user <code>oracleuser</code> enough privileges to login, create and modify a table:</p>
<pre><code class="language-sql">&gt; GRANT CREATE SESSION TO oracleuser; 
&gt; GRANT CREATE TABLE TO oracleuser;
&gt; GRANT UNLIMITED TABLESPACE TO oracleuser;
&gt; exit
</code></pre>
</li>
<li>
<p>Log in as user <code>oracleuser</code>:</p>
<pre><code class="language-shell">$ sqlplus oracleuser
</code></pre>
</li>
<li>
<p>Create a table named <code>countries</code>, insert some data into this table, and commit the transaction:</p>
<pre><code class="language-sql">&gt; CREATE TABLE countries (country_id int, country_name varchar(40), population float);
&gt; INSERT INTO countries (country_id, country_name, population) values (3, 'Portugal', 10.28);
&gt; INSERT INTO countries (country_id, country_name, population) values (24, 'Zambia', 17.86);
&gt; COMMIT;
</code></pre>
</li>
</ol>
<h2 id="configure-the-oracle-connector"><a class="header" href="#configure-the-oracle-connector"><a id="ex_jdbconfig"></a>Configure the Oracle Connector</a></h2>
<p>You must create a JDBC server configuration for Oracle, download the Oracle driver JAR file to your system, copy the JAR file to the PXF user configuration directory, synchronize the PXF configuration, and then restart PXF.</p>
<p>This procedure will typically be performed by the SynxDB administrator.</p>
<ol>
<li>
<p>Download the Oracle JDBC driver and place it under <code>$PXF_BASE/lib</code> of your SynxDB coordinator host. If you <a href="about_pxf_dir.html#movebase">relocated $PXF_BASE</a>, make sure you use the updated location. You can download a Oracle JDBC driver from your preferred download location. The following example places a driver downloaded from Oracle webiste under <code>$PXF_BASE/lib</code> of the SynxDB coordinator:</p>
<ol>
<li>
<p>If you did not relocate <code>$PXF_BASE</code>, run the following from the SynxDB coordinator:</p>
<pre><code class="language-shell">gpadmin@coordinator$ scp ojdbc10.jar gpadmin@coordinator:/usr/local/pxf-gp&lt;version&gt;/lib/
</code></pre>
</li>
<li>
<p>If you relocated <code>$PXF_BASE</code>, run the following from the SynxDB coordinator:</p>
<pre><code class="language-shell">gpadmin@coordinator$ scp ojdbc10.jar gpadmin@coordinator:$PXF_BASE/lib/
</code></pre>
</li>
</ol>
</li>
<li>
<p>Synchronize the PXF configuration, and then restart PXF:</p>
<pre><code class="language-shell">gpadmin@coordinator$ pxf cluster sync
gpadmin@coordinator$ pxf cluster restart
</code></pre>
</li>
<li>
<p>Create a JDBC server configuration for Oracle as described in <a href="jdbc_cfg.html#cfg_proc">Example Configuration Procedure</a>, naming the server directory <code>oracle</code>. The <code>jdbc-site.xml</code> file contents should look similar to the following (substitute your Oracle host system for <code>oracleserverhost</code>, and the value of your Oracle service name for <code>orcl</code>):</p>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;configuration&gt;
    &lt;property&gt;
        &lt;name&gt;jdbc.driver&lt;/name&gt;
        &lt;value&gt;oracle.jdbc.driver.OracleDriver&lt;/value&gt;
        &lt;description&gt;Class name of the JDBC driver&lt;/description&gt;
    &lt;/property&gt;
    &lt;property&gt;
        &lt;name&gt;jdbc.url&lt;/name&gt;
        &lt;value&gt;jdbc:oracle:thin:@oracleserverhost:1521/orcl&lt;/value&gt;
        &lt;description&gt;The URL that the JDBC driver can use to connect to the database&lt;/description&gt;
    &lt;/property&gt;
    &lt;property&gt;
        &lt;name&gt;jdbc.user&lt;/name&gt;
        &lt;value&gt;oracleuser&lt;/value&gt;
        &lt;description&gt;User name for connecting to the database&lt;/description&gt;
    &lt;/property&gt;
    &lt;property&gt;
        &lt;name&gt;jdbc.password&lt;/name&gt;
        &lt;value&gt;mypassword&lt;/value&gt;
        &lt;description&gt;Password for connecting to the database&lt;/description&gt;
    &lt;/property&gt;
&lt;/configuration&gt;  
</code></pre>
</li>
<li>
<p>Synchronize the PXF server configuration to the SynxDB cluster:</p>
<pre><code class="language-shell">gpadmin@coordinator$ pxf cluster sync
</code></pre>
</li>
</ol>
<h2 id="read-from-the-oracle-table"><a class="header" href="#read-from-the-oracle-table"><a id="ex_readjdbc"></a>Read from the Oracle Table</a></h2>
<p>Perform the following procedure to create a PXF external table that references the <code>countries</code> Oracle table that you created in the previous section, and reads the data in the table:</p>
<ol>
<li>
<p>Create the PXF external table specifying the <code>jdbc</code> profile. For example:</p>
<pre><code class="language-sql">gpadmin=# CREATE EXTERNAL TABLE oracle_countries (country_id int, country_name varchar, population float)
          LOCATION('pxf://oracleuser.countries?PROFILE=jdbc&amp;SERVER=oracle')
          FORMAT 'CUSTOM' (formatter='pxfwritable_import');
</code></pre>
</li>
<li>
<p>Display all rows of the <code>oracle_countries</code> table:</p>
<pre><code class="language-sql">gpadmin=# SELECT * FROM oracle_countries ;
country_id | country_name | population 
-----------+--------------+------------
         3 | Portugal     |      10.28
        24 | Zambia       |      17.86
(2 rows)
</code></pre>
</li>
</ol>
<h2 id="write-to-the-oracle-table"><a class="header" href="#write-to-the-oracle-table"><a id="ex_writejdbc"></a>Write to the Oracle Table</a></h2>
<p>Perform the following procedure to insert some data into the <code>countries</code> Oracle table and then read from the table. You must create a new external table for the write operation.</p>
<ol>
<li>
<p>Create a writable PXF external table specifying the <code>jdbc</code> profile. For example:</p>
<pre><code class="language-sql">gpadmin=# CREATE WRITABLE EXTERNAL TABLE oracle_countries_write (country_id int, country_name varchar, population float)
          LOCATION('pxf://oracleuser.countries?PROFILE=jdbc&amp;SERVER=oracle')
          FORMAT 'CUSTOM' (formatter='pxfwritable_export');
</code></pre>
</li>
<li>
<p>Insert some data into the <code>oracle_countries_write</code> table. For example:</p>
<pre><code class="language-sql">gpadmin=# INSERT INTO oracle_countries_write VALUES (66, 'Colombia', 50.34);
</code></pre>
</li>
<li>
<p>Use the <code>oracle_countries</code> readable external table that you created in the previous section to view the new data in the <code>countries</code> Oracle table:</p>
<pre><code class="language-sql">gpadmin=#  SELECT * FROM oracle_countries;
country_id | country_name | population
------------+--------------+------------
         3 | Portugal     |      10.28
        24 | Zambia       |      17.86
        66 | Colombia     |      50.34
(3 rows)
</code></pre>
</li>
</ol>
<h2 id="about-setting-oracle-parallel-query-session-parameters"><a class="header" href="#about-setting-oracle-parallel-query-session-parameters"><a id="parallel"></a>About Setting Oracle Parallel Query Session Parameters</a></h2>
<p>PXF recognizes certain Oracle session parameters that control parallel query execution, and will set these parameters before it runs a query. You specify these session parameters via properties that you set in the <code>jdbc-site.xml</code> configuration file for the Oracle PXF server.</p>
<p>For more information about parallel query execution in Oracle databases, refer to the <a href="https://docs.oracle.com/database/121/VLDBG/GUID-3E2AE088-2505-465E-A8B2-AC38813EA355.htm#VLDBG010">Oracle documentation</a>.</p>
<p>PXF names an Oracle parallel query session property as follows:</p>
<pre><code>jdbc.session.property.alter_session_parallel.&lt;n&gt;
</code></pre>
<p><code>&lt;n&gt;</code> is an ordinal number that identifies a session parameter setting; for example, <code>jdbc.session.property.alter_session_parallel.1</code>. You may specify multiple property settings, where <code>&lt;n&gt;</code> is unique in each.</p>
<p>A value that you specify for an Oracle parallel query execution property must conform to the following format:</p>
<pre><code>&lt;action&gt;.&lt;statement_type&gt;[.&lt;degree_of_parallelism&gt;]
</code></pre>
<p>where:</p>
<div class="table-wrapper"><table><thead><tr><th>Keyword</th><th>Values/Description</th></tr></thead><tbody>
<tr><td><code>&lt;action&gt;</code></td><td><code>enable</code></br><code>disable</code></br><code>force</code></td></tr>
<tr><td><code>&lt;statement_type&gt;</code></td><td><code>query</code></br><code>ddl</code></br><code>dml</code></br></td></tr>
<tr><td><code>&lt;degree_of_parallelism&gt;</code></td><td>The (integer) number of parallel sessions that you can force when <code>&lt;action&gt;</code> specifies <code>force</code>. PXF ignores this value for other <code>&lt;action&gt;</code> settings.</td></tr>
</tbody></table>
</div>
<p>Example parallel query execution property settings in the <code>jdbc-site.xml</code> configuration file for an Oracle PXF server follow:</p>
<pre><code class="language-xml">&lt;property&gt;
    &lt;name&gt;jdbc.session.property.alter_session_parallel.1&lt;/name&gt;
    &lt;value&gt;force.query.4&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
    &lt;name&gt;jdbc.session.property.alter_session_parallel.2&lt;/name&gt;
    &lt;value&gt;disable.ddl&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
    &lt;name&gt;jdbc.session.property.alter_session_parallel.3&lt;/name&gt;
    &lt;value&gt;enable.dml&lt;/value&gt;
&lt;/property&gt;
</code></pre>
<p>With this configuration, PXF runs the following commands before it submits the query to the Oracle database:</p>
<pre><code class="language-sql">ALTER SESSION FORCE PARALLEL QUERY PARALLEL 4;
ALTER SESSION DISABLE PARALLEL DDL;
ALTER SESSION ENABLE PARALLEL DML;
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../pxf/jdbc_pxf_mysql.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../pxf/jdbc_pxf_trino.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../pxf/jdbc_pxf_mysql.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../pxf/jdbc_pxf_trino.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
