<!DOCTYPE HTML>
<html lang="en" class="ayu sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Using Functions and Operators - SynxDB 2 Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../../favicon.svg">
        <link rel="shortcut icon" href="../../../favicon.png">
        <link rel="stylesheet" href="../../../css/variables.css">
        <link rel="stylesheet" href="../../../css/general.css">
        <link rel="stylesheet" href="../../../css/chrome.css">
        <link rel="stylesheet" href="../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../highlight.css">
        <link rel="stylesheet" href="../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">SynxDB 2 Documentation</h1>

                    <div class="right-buttons">
                        <a href="../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                        &nbsp;&nbsp;&nbsp;&nbsp;
                        <a href="https://www.synxdata.com/"><img id="fa fa-print" src="../../../SYNX-Text-and-Circular-Logo-142x28-White-text-Black-background.png" alt="Synx Data Labs Logo"/></a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="using-functions-and-operators"><a class="header" href="#using-functions-and-operators">Using Functions and Operators</a></h1>
<p>Description of user-defined and built-in functions and operators in SynxDB.</p>
<ul>
<li><a href="#topic27">Using Functions in SynxDB</a></li>
<li><a href="#topic28">User-Defined Functions</a></li>
<li><a href="#topic29">Built-in Functions and Operators</a></li>
<li><a href="#topic30">Window Functions</a></li>
<li><a href="#topic31">Advanced Aggregate Functions</a></li>
</ul>
<h2 id="using-functions-in-synxdb"><a class="header" href="#using-functions-in-synxdb"><a id="topic27"></a>Using Functions in SynxDB</a></h2>
<p>When you invoke a function in SynxDB, function attributes control the execution of the function. The volatility attributes (<code>IMMUTABLE</code>, <code>STABLE</code>, <code>VOLATILE</code>) and the <code>EXECUTE ON</code> attributes control two different aspects of function execution. In general, volatility indicates when the function is run, and <code>EXECUTE ON</code> indicates where it is run. The volatility attributes are PostgreSQL based attributes, the <code>EXECUTE ON</code> attributes are SynxDB attributes.</p>
<p>For example, a function defined with the <code>IMMUTABLE</code> attribute can be run at query planning time, while a function with the <code>VOLATILE</code> attribute must be run for every row in the query. A function with the <code>EXECUTE ON MASTER</code> attribute runs only on the master instance, and a function with the <code>EXECUTE ON ALL SEGMENTS</code> attribute runs on all primary segment instances (not the master).</p>
<p>These tables summarize what SynxDB assumes about function execution based on the attribute.</p>
<div class="table-wrapper"><table><thead><tr><th>Function Attribute</th><th>SynxDB Support</th><th>Description</th><th>Comments</th></tr></thead><tbody>
<tr><td>IMMUTABLE</td><td>Yes</td><td>Relies only on information directly in its argument list. Given the same argument values, always returns the same result.</td><td> </td></tr>
<tr><td>STABLE</td><td>Yes, in most cases</td><td>Within a single table scan, returns the same result for same argument values, but results change across SQL statements.</td><td>Results depend on database lookups or parameter values. <code>current_timestamp</code> family of functions is <code>STABLE</code>; values do not change within an execution.</td></tr>
<tr><td>VOLATILE</td><td>Restricted</td><td>Function values can change within a single table scan. For example: <code>random()</code>, <code>timeofday()</code>. This is the default attribute.</td><td>Any function with side effects is volatile, even if its result is predictable. For example: <code>setval()</code>.</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>Function Attribute</th><th>Description</th><th>Comments</th></tr></thead><tbody>
<tr><td>EXECUTE ON ANY</td><td>Indicates that the function can be run on the master, or any segment instance, and it returns the same result regardless of where it runs. This is the default attribute.</td><td>SynxDB determines where the function runs.</td></tr>
<tr><td>EXECUTE ON MASTER</td><td>Indicates that the function must be run on the master instance.</td><td>Specify this attribute if the user-defined function runs queries to access tables.</td></tr>
<tr><td>EXECUTE ON ALL SEGMENTS</td><td>Indicates that for each invocation, the function must be run on all primary segment instances, but not the master.</td><td> </td></tr>
<tr><td>EXECUTE ON INITPLAN</td><td>Indicates that the function contains an SQL command that dispatches queries to the segment instances and requires special processing on the master instance by SynxDB when possible.</td><td> </td></tr>
</tbody></table>
</div>
<p>You can display the function volatility and <code>EXECUTE ON</code> attribute information with the psql <code>\df+ function</code> command.</p>
<p>Refer to the PostgreSQL <a href="https://www.postgresql.org/docs/9.4/xfunc-volatility.html">Function Volatility Categories</a> documentation for additional information about the SynxDB function volatility classifications.</p>
<p>For more information about <code>EXECUTE ON</code> attributes, see <a href="../../../ref_guide/sql_commands/CREATE_FUNCTION.html">CREATE FUNCTION</a>.</p>
<p>In SynxDB, data is divided up across segments — each segment is a distinct PostgreSQL database. To prevent inconsistent or unexpected results, do not run functions classified as <code>VOLATILE</code> at the segment level if they contain SQL commands or modify the database in any way. For example, functions such as <code>setval()</code> are not allowed to run on distributed data in SynxDB because they can cause inconsistent data between segment instances.</p>
<p>A function can run read-only queries on replicated tables (<code>DISTRIBUTED REPLICATED</code>) on the segments, but any SQL command that modifies data must run on the master instance.</p>
<blockquote>
<p><strong>Note</strong> The hidden system columns (<code>ctid</code>, <code>cmin</code>, <code>cmax</code>, <code>xmin</code>, <code>xmax</code>, and <code>gp_segment_id</code>) cannot be referenced in user queries on replicated tables because they have no single, unambiguous value. SynxDB returns a <code>column does not exist</code> error for the query.</p>
</blockquote>
<p>To ensure data consistency, you can safely use <code>VOLATILE</code> and <code>STABLE</code> functions in statements that are evaluated on and run from the master. For example, the following statements run on the master (statements without a <code>FROM</code> clause):</p>
<pre><code>SELECT setval('myseq', 201);
SELECT foo();
</code></pre>
<p>If a statement has a <code>FROM</code> clause containing a distributed table <em>and</em> the function in the <code>FROM</code> clause returns a set of rows, the statement can run on the segments:</p>
<pre><code>SELECT * from foo();
</code></pre>
<p>SynxDB does not support functions that return a table reference (<code>rangeFuncs</code>) or functions that use the <code>refCursor</code> data type.</p>
<h3 id="function-volatility-and-plan-caching"><a class="header" href="#function-volatility-and-plan-caching"><a id="topic281"></a>Function Volatility and Plan Caching</a></h3>
<p>There is relatively little difference between the <code>STABLE</code> and <code>IMMUTABLE</code> function volatility categories for simple interactive queries that are planned and immediately run. It does not matter much whether a function is run once during planning or once during query execution start up. But there is a big difference when you save the plan and reuse it later. If you mislabel a function <code>IMMUTABLE</code>, SynxDB may prematurely fold it to a constant during planning, possibly reusing a stale value during subsequent execution of the plan. You may run into this hazard when using <code>PREPARE</code>d statements, or when using languages such as PL/pgSQL that cache plans.</p>
<h2 id="user-defined-functions"><a class="header" href="#user-defined-functions"><a id="topic28"></a>User-Defined Functions</a></h2>
<p>SynxDB supports user-defined functions. See <a href="https://www.postgresql.org/docs/9.4/extend.html">Extending SQL</a> in the PostgreSQL documentation for more information.</p>
<p>Use the <code>CREATE FUNCTION</code> statement to register user-defined functions that are used as described in <a href="#topic27">Using Functions in SynxDB</a>. By default, user-defined functions are declared as <code>VOLATILE</code>, so if your user-defined function is <code>IMMUTABLE</code> or <code>STABLE</code>, you must specify the correct volatility level when you register your function.</p>
<p>By default, user-defined functions are declared as <code>EXECUTE ON ANY</code>. A function that runs queries to access tables is supported only when the function runs on the master instance, except that a function can run <code>SELECT</code> commands that access only replicated tables on the segment instances. A function that accesses hash-distributed or randomly distributed tables must be defined with the <code>EXECUTE ON MASTER</code> attribute. Otherwise, the function might return incorrect results when the function is used in a complicated query. Without the attribute, planner optimization might determine it would be beneficial to push the function invocation to segment instances.</p>
<p>When you create user-defined functions, avoid using fatal errors or destructive calls. SynxDB may respond to such errors with a sudden shutdown or restart.</p>
<p>In SynxDB, the shared library files for user-created functions must reside in the same library path location on every host in the SynxDB array (masters, segments, and mirrors).</p>
<p>You can also create and run anonymous code blocks that are written in a SynxDB procedural language such as PL/pgSQL. The anonymous blocks run as transient anonymous functions. For information about creating and running anonymous blocks, see the <a href="../../../ref_guide/sql_commands/DO.html"><code>DO</code></a> command.</p>
<h2 id="built-in-functions-and-operators"><a class="header" href="#built-in-functions-and-operators"><a id="topic29"></a>Built-in Functions and Operators</a></h2>
<p>The following table lists the categories of built-in functions and operators supported by PostgreSQL. All functions and operators are supported in SynxDB as in PostgreSQL with the exception of <code>STABLE</code> and <code>VOLATILE</code> functions, which are subject to the restrictions noted in <a href="#topic27">Using Functions in SynxDB</a>. See the <a href="https://www.postgresql.org/docs/9.4/functions.html">Functions and Operators</a> section of the PostgreSQL documentation for more information about these built-in functions and operators.</p>
<p>SynxDB includes JSON processing functions that manipulate values the <code>json</code> data type. For information about JSON data, see <a href="json-data.html">Working with JSON Data</a>.</p>
<table class="table" id="topic29__in204913"><caption><span class="table--title-label">Table 3. </span><span class="title">Built-in functions and operators</span></caption><colgroup><col style="width:27.67527675276753%"><col style="width:18.45018450184502%"><col style="width:22.14022140221402%"><col style="width:31.73431734317343%"></colgroup><thead class="thead">
                        <tr class="row">
                            <th class="entry" id="topic29__in204913__entry__1">Operator/Function Category</th>
                            <th class="entry" id="topic29__in204913__entry__2">VOLATILE Functions</th>
                            <th class="entry" id="topic29__in204913__entry__3">STABLE Functions</th>
                            <th class="entry" id="topic29__in204913__entry__4">Restrictions</th>
                        </tr>
                    </thead><tbody class="tbody">
                        <tr class="row">
                            <td class="entry" headers="topic29__in204913__entry__1">
                                <a class="xref" href="https://www.postgresql.org/docs/9.4/functions-logical.html" target="_blank" rel="external noopener">Logical Operators</a>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__2"></td>
                            <td class="entry" headers="topic29__in204913__entry__3"></td>
                            <td class="entry" headers="topic29__in204913__entry__4"></td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic29__in204913__entry__1">
                                <a class="xref" href="https://www.postgresql.org/docs/9.4/functions-comparison.html" target="_blank" rel="external noopener">Comparison Operators</a>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__2"></td>
                            <td class="entry" headers="topic29__in204913__entry__3"></td>
                            <td class="entry" headers="topic29__in204913__entry__4"></td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic29__in204913__entry__1">
                                <a class="xref" href="https://www.postgresql.org/docs/9.4/functions-math.html" target="_blank" rel="external noopener">
                                    <span class="ph">Mathematical Functions and Operators</span>
                                </a>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__2">random<p class="p">setseed</p></td>
                            <td class="entry" headers="topic29__in204913__entry__3"></td>
                            <td class="entry" headers="topic29__in204913__entry__4"></td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic29__in204913__entry__1">
                                <a class="xref" href="https://www.postgresql.org/docs/9.4/functions-string.html" target="_blank" rel="external noopener">
                                    <span class="ph">String Functions and Operators</span>
                                </a>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__2">
                                <em class="ph i">All built-in conversion functions</em>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__3">convert<p class="p">pg_client_encoding</p></td>
                            <td class="entry" headers="topic29__in204913__entry__4"></td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic29__in204913__entry__1">
                                <a class="xref" href="https://www.postgresql.org/docs/9.4/functions-binarystring.html" target="_blank" rel="external noopener">
                                    <span class="ph">Binary String Functions and Operators</span>
                                </a>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__2"></td>
                            <td class="entry" headers="topic29__in204913__entry__3"></td>
                            <td class="entry" headers="topic29__in204913__entry__4"></td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic29__in204913__entry__1">
                                <a class="xref" href="https://www.postgresql.org/docs/9.4/functions-bitstring.html" target="_blank" rel="external noopener">
                                    <span class="ph">Bit String Functions and Operators</span>
                                </a>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__2"></td>
                            <td class="entry" headers="topic29__in204913__entry__3"></td>
                            <td class="entry" headers="topic29__in204913__entry__4"></td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic29__in204913__entry__1">
                                <a class="xref" href="https://www.postgresql.org/docs/9.4/functions-matching.html" target="_blank" rel="external noopener">
                                    <span class="ph">Pattern Matching</span>
                                </a>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__2"></td>
                            <td class="entry" headers="topic29__in204913__entry__3"></td>
                            <td class="entry" headers="topic29__in204913__entry__4"></td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic29__in204913__entry__1">
                                <a class="xref" href="https://www.postgresql.org/docs/9.4/functions-formatting.html" target="_blank" rel="external noopener">
                                    <span class="ph">Data Type Formatting Functions</span>
                                </a>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__2"></td>
                            <td class="entry" headers="topic29__in204913__entry__3">to_char<p class="p">to_timestamp</p></td>
                            <td class="entry" headers="topic29__in204913__entry__4"></td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic29__in204913__entry__1">
                                <a class="xref" href="https://www.postgresql.org/docs/9.4/functions-datetime.html" target="_blank" rel="external noopener"> Date/Time Functions and Operators</a>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__2">timeofday</td>
                            <td class="entry" headers="topic29__in204913__entry__3">age<p class="p">current_date</p><p class="p">current_time</p><p class="p">current_timestamp</p><p class="p">localtime</p><p class="p">localtimestamp</p><p class="p">now</p></td>
                            <td class="entry" headers="topic29__in204913__entry__4"></td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic29__in204913__entry__1">
                                <a class="xref" href="https://www.postgresql.org/docs/9.4/functions-enum.html" target="_blank" rel="external noopener"> Enum Support Functions </a>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__2"></td>
                            <td class="entry" headers="topic29__in204913__entry__3"></td>
                            <td class="entry" headers="topic29__in204913__entry__4"></td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic29__in204913__entry__1">
                                <a class="xref" href="https://www.postgresql.org/docs/9.4/functions-geometry.html" target="_blank" rel="external noopener">
                                    <span class="ph">Geometric Functions and Operators</span>
                                </a>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__2"></td>
                            <td class="entry" headers="topic29__in204913__entry__3"></td>
                            <td class="entry" headers="topic29__in204913__entry__4"></td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic29__in204913__entry__1">
                                <a class="xref" href="https://www.postgresql.org/docs/9.4/functions-net.html" target="_blank" rel="external noopener">
                                    <span class="ph">Network Address Functions and Operators</span>
                                </a>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__2"></td>
                            <td class="entry" headers="topic29__in204913__entry__3"></td>
                            <td class="entry" headers="topic29__in204913__entry__4"></td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic29__in204913__entry__1">
                                <a class="xref" href="https://www.postgresql.org/docs/9.4/functions-sequence.html" target="_blank" rel="external noopener">
                                    <span class="ph">Sequence Manipulation Functions</span>
                                </a>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__2">nextval()<p class="p">setval()</p></td>
                            <td class="entry" headers="topic29__in204913__entry__3"></td>
                            <td class="entry" headers="topic29__in204913__entry__4"></td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic29__in204913__entry__1">
                                <a class="xref" href="https://www.postgresql.org/docs/9.4/functions-conditional.html" target="_blank" rel="external noopener">
                                    <span class="ph">Conditional Expressions</span>
                                </a>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__2"></td>
                            <td class="entry" headers="topic29__in204913__entry__3"></td>
                            <td class="entry" headers="topic29__in204913__entry__4"></td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic29__in204913__entry__1">
                                <a class="xref" href="https://www.postgresql.org/docs/9.4/functions-array.html" target="_blank" rel="external noopener">
                                    <span class="ph">Array Functions and Operators</span>
                                </a>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__2"></td>
                            <td class="entry" headers="topic29__in204913__entry__3">
                                <em class="ph i">All array functions</em>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__4"></td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic29__in204913__entry__1">
                                <a class="xref" href="https://www.postgresql.org/docs/9.4/functions-aggregate.html" target="_blank" rel="external noopener">
                                    <span class="ph">Aggregate Functions</span>
                                </a>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__2"></td>
                            <td class="entry" headers="topic29__in204913__entry__3"></td>
                            <td class="entry" headers="topic29__in204913__entry__4"></td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic29__in204913__entry__1">
                                <a class="xref" href="https://www.postgresql.org/docs/9.4/functions-subquery.html" target="_blank" rel="external noopener">
                                    <span class="ph">Subquery Expressions</span>
                                </a>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__2"></td>
                            <td class="entry" headers="topic29__in204913__entry__3"></td>
                            <td class="entry" headers="topic29__in204913__entry__4"></td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic29__in204913__entry__1">
                                <a class="xref" href="https://www.postgresql.org/docs/9.4/functions-comparisons.html" target="_blank" rel="external noopener">
                                    <span class="ph">Row and Array Comparisons</span>
                                </a>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__2"></td>
                            <td class="entry" headers="topic29__in204913__entry__3"></td>
                            <td class="entry" headers="topic29__in204913__entry__4"></td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic29__in204913__entry__1">
                                <a class="xref" href="https://www.postgresql.org/docs/9.4/functions-srf.html" target="_blank" rel="external noopener">
                                    <span class="ph">Set Returning Functions</span>
                                </a>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__2">generate_series</td>
                            <td class="entry" headers="topic29__in204913__entry__3"></td>
                            <td class="entry" headers="topic29__in204913__entry__4"></td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic29__in204913__entry__1">
                                <a class="xref" href="https://www.postgresql.org/docs/9.4/functions-info.html" target="_blank" rel="external noopener">
                                    <span class="ph">System Information Functions</span>
                                </a>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__2"></td>
                            <td class="entry" headers="topic29__in204913__entry__3">
                                <em class="ph i">All session information functions</em>
                                <p class="p">
                                    <em class="ph i">All access privilege inquiry functions</em>
                                </p><p class="p">
                                    <em class="ph i">All schema visibility inquiry functions</em>
                                </p><p class="p">
                                    <em class="ph i">All system catalog information functions</em>
                                </p><p class="p">
                                    <em class="ph i">All comment information functions</em>
                                </p><p class="p">
                                    <em class="ph i">All transaction ids and snapshots</em>
                                </p></td>
                            <td class="entry" headers="topic29__in204913__entry__4"></td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic29__in204913__entry__1">
                                <a class="xref" href="https://www.postgresql.org/docs/9.4/functions-admin.html" target="_blank" rel="external noopener">
                                    <span class="ph">System Administration Functions</span>
                                </a>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__2">set_config<p class="p">pg_cancel_backend</p><p class="p">pg_terminate_backend</p><p class="p">pg_reload_conf</p><p class="p">pg_rotate_logfile</p><p class="p">pg_start_backup</p><p class="p">pg_stop_backup</p><p class="p">pg_size_pretty</p><p class="p">pg_ls_dir</p><p class="p">pg_read_file</p><p class="p">pg_stat_file</p></td>
                            <td class="entry" headers="topic29__in204913__entry__3">current_setting<p class="p"><em class="ph i">All database object size
                                        functions</em></p></td>
                            <td class="entry" headers="topic29__in204913__entry__4"><strong class="ph b">Note:</strong> The function
                                    <code class="ph codeph">pg_column_size</code> displays bytes required to store
                                the value, possibly with TOAST compression.</td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic29__in204913__entry__1">
                                <a class="xref" href="https://www.postgresql.org/docs/9.4/functions-xml.html" target="_blank" rel="external noopener">XML Functions</a> and function-like
                                expressions </td>
                            <td class="entry" headers="topic29__in204913__entry__2"></td>
                            <td class="entry" headers="topic29__in204913__entry__3">
                                <p class="p">cursor_to_xml(cursor refcursor, count int, nulls boolean,
                                    tableforest boolean, targetns text)</p>
                                <p class="p">cursor_to_xmlschema(cursor refcursor, nulls boolean, tableforest
                                    boolean, targetns text)</p>
                                <p class="p">database_to_xml(nulls boolean, tableforest boolean, targetns
                                    text)</p>
                                <p class="p">database_to_xmlschema(nulls boolean, tableforest boolean,
                                    targetns text)</p>
                                <p class="p">database_to_xml_and_xmlschema( nulls boolean, tableforest
                                    boolean, targetns text)</p>
                                <p class="p">query_to_xml(query text, nulls boolean, tableforest boolean,
                                    targetns text)</p>
                                <p class="p">query_to_xmlschema(query text, nulls boolean, tableforest
                                    boolean, targetns text)</p>
                                <p class="p">query_to_xml_and_xmlschema( query text, nulls boolean,
                                    tableforest boolean, targetns text)</p>
                                <p class="p">schema_to_xml(schema name, nulls boolean, tableforest boolean,
                                    targetns text)</p>
                                <p class="p">schema_to_xmlschema( schema name, nulls boolean, tableforest
                                    boolean, targetns text)</p>
                                <p class="p">schema_to_xml_and_xmlschema( schema name, nulls boolean,
                                    tableforest boolean, targetns text)</p>
                                <p class="p">table_to_xml(tbl regclass, nulls boolean, tableforest boolean,
                                    targetns text)</p>
                                <p class="p">table_to_xmlschema( tbl regclass, nulls boolean, tableforest
                                    boolean, targetns text)</p>
                                <p class="p">table_to_xml_and_xmlschema( tbl regclass, nulls boolean,
                                    tableforest boolean, targetns text)</p>
                                <p class="p">xmlagg(xml)</p>
                                <p class="p">xmlconcat(xml[, ...])</p>
                                <p class="p">xmlelement(name name [, xmlattributes(value [AS attname] [, ...
                                    ])] [, content, ...])</p>
                                <p class="p">xmlexists(text, xml)</p>
                                <p class="p">xmlforest(content [AS name] [, ...])</p>
                                <p class="p">xml_is_well_formed(text)</p>
                                <p class="p">xml_is_well_formed_document(text)</p>
                                <p class="p">xml_is_well_formed_content(text)</p>
                                <p class="p">xmlparse ( { DOCUMENT | CONTENT } value)</p>
                                <p class="p">xpath(text, xml)</p>
                                <p class="p">xpath(text, xml, text[])</p>
                                <p class="p">xpath_exists(text, xml)</p>
                                <p class="p">xpath_exists(text, xml, text[])</p>
                                <p class="p">xmlpi(name target [, content])</p>
                                <p class="p">xmlroot(xml, version text | no value [, standalone yes|no|no
                                    value])</p>
                                <p class="p">xmlserialize ( { DOCUMENT | CONTENT } value AS type )</p>
                                <p class="p">xml(text)</p>
                                <p class="p">text(xml)</p>
                                <p class="p">xmlcomment(xml)</p>
                                <p class="p">xmlconcat2(xml, xml)</p>
                            </td>
                            <td class="entry" headers="topic29__in204913__entry__4"></td>
                        </tr>
                    </tbody></table>
<h2 id="window-functions"><a class="header" href="#window-functions"><a id="topic30"></a>Window Functions</a></h2>
<p>The following built-in window functions are SynxDB extensions to the PostgreSQL database. All window functions are <em>immutable</em>. For more information about window functions, see <a href="defining-queries.html">Window Expressions</a>.</p>
<table class="table" id="topic30__in164369"><caption><span class="table--title-label">Table 4. </span><span class="title">Window functions</span></caption><colgroup><col style="width:22.86775087590859%"><col style="width:15.426449824818283%"><col style="width:39.21978769021597%"><col style="width:22.486011609057158%"></colgroup><thead class="thead">
                        <tr class="row">
                            <th class="entry" id="topic30__in164369__entry__1">Function</th>
                            <th class="entry" id="topic30__in164369__entry__2">Return Type</th>
                            <th class="entry" id="topic30__in164369__entry__3">Full Syntax</th>
                            <th class="entry" id="topic30__in164369__entry__4">Description</th>
                        </tr>
                    </thead><tbody class="tbody">
                        <tr class="row">
                            <td class="entry" headers="topic30__in164369__entry__1">
                                <code class="ph codeph">cume_dist()</code>
                            </td>
                            <td class="entry" headers="topic30__in164369__entry__2">
                                <code class="ph codeph">double precision</code>
                            </td>
                            <td class="entry" headers="topic30__in164369__entry__3">
                                <code class="ph codeph">CUME_DIST() OVER ( [PARTITION BY </code>
                                <span class="ph">expr</span>
                                <code class="ph codeph">] ORDER BY </code>
                                <span class="ph">expr</span>
                                <code class="ph codeph"> )</code>
                            </td>
                            <td class="entry" headers="topic30__in164369__entry__4">Calculates the cumulative distribution of a value
                                in a group of values. Rows with equal values always evaluate to the
                                same cumulative distribution value.</td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic30__in164369__entry__1">
                                <code class="ph codeph">dense_rank()</code>
                            </td>
                            <td class="entry" headers="topic30__in164369__entry__2">
                                <code class="ph codeph">bigint</code>
                            </td>
                            <td class="entry" headers="topic30__in164369__entry__3">
                                <code class="ph codeph">DENSE_RANK () OVER ( [PARTITION BY </code>
                                <span class="ph">expr</span>
                                <code class="ph codeph">] ORDER BY </code>
                                <span class="ph">expr</span>
                                <code class="ph codeph">)</code>
                            </td>
                            <td class="entry" headers="topic30__in164369__entry__4">Computes the rank of a row in an ordered group of
                                rows without skipping rank values. Rows with equal values are given
                                the same rank value.</td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic30__in164369__entry__1">
                                <code class="ph codeph">first_value(<em class="ph i">expr</em>)</code>
                            </td>
                            <td class="entry" headers="topic30__in164369__entry__2">same as input <span class="ph">expr</span> type</td>
                            <td class="entry" headers="topic30__in164369__entry__3">
                                <code class="ph codeph">FIRST_VALUE(</code>
                                <span class="ph">expr</span>
                                <code class="ph codeph">) OVER ( [PARTITION BY </code>
                                <span class="ph">expr</span>
                                <code class="ph codeph">] ORDER BY </code>
                                <span class="ph">expr</span>
                                <code class="ph codeph"> [ROWS|RANGE </code>
                                <span class="ph">frame_expr</span>
                                <code class="ph codeph">] )</code>
                            </td>
                            <td class="entry" headers="topic30__in164369__entry__4">Returns the first value in an ordered set of
                                values.</td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic30__in164369__entry__1">
                                <code class="ph codeph">lag(<em class="ph i">expr</em> [,<em class="ph i">offset</em>] [,<em class="ph i">default</em>])</code>
                            </td>
                            <td class="entry" headers="topic30__in164369__entry__2">same as input <em class="ph i">expr</em> type</td>
                            <td class="entry" headers="topic30__in164369__entry__3">
                                <code class="ph codeph">LAG(</code>
                                <em class="ph i">expr</em>
                                <code class="ph codeph"> [,</code>
                                <em class="ph i">offset</em>
                                <code class="ph codeph">] [,</code>
                                <em class="ph i">default</em>
                                <code class="ph codeph">]) OVER ( [PARTITION BY </code>
                                <em class="ph i">expr</em>
                                <code class="ph codeph">] ORDER BY </code>
                                <em class="ph i">expr</em>
                                <code class="ph codeph"> )</code>
                            </td>
                            <td class="entry" headers="topic30__in164369__entry__4">Provides access to more than one row of the same
                                table without doing a self join. Given a series of rows returned
                                from a query and a position of the cursor, <code class="ph codeph">LAG</code>
                                provides access to a row at a given physical offset prior to that
                                position. The default <code class="ph codeph">offset</code> is 1. <em class="ph i">default</em>
                                sets the value that is returned if the offset goes beyond the scope
                                of the window. If <em class="ph i">default</em> is not specified, the default value
                                is null.</td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic30__in164369__entry__1">
                                <code class="ph codeph">last_value(<em class="ph i">expr</em></code>)</td>
                            <td class="entry" headers="topic30__in164369__entry__2">same as input <em class="ph i">expr</em> type</td>
                            <td class="entry" headers="topic30__in164369__entry__3">
                                <code class="ph codeph">LAST_VALUE(<em class="ph i">expr</em>) OVER ( [PARTITION BY <em class="ph i">expr</em>]
                                    ORDER BY <em class="ph i">expr</em> [ROWS|RANGE <em class="ph i">frame_expr</em>] )</code>
                            </td>
                            <td class="entry" headers="topic30__in164369__entry__4">Returns the last value in an ordered set of
                                values.</td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic30__in164369__entry__1">
                                <code class="ph codeph">
                                    <code class="ph codeph">lead(<em class="ph i">expr</em> [,<em class="ph i">offset</em>]
                                        [,<em class="ph i">default</em>])</code>
                                </code>
                            </td>
                            <td class="entry" headers="topic30__in164369__entry__2">same as input <em class="ph i">expr</em> type</td>
                            <td class="entry" headers="topic30__in164369__entry__3">
                                <code class="ph codeph">LEAD(<em class="ph i">expr </em>[,<em class="ph i">offset</em>]
                                        [,<em class="ph i">expr</em><em class="ph i">default</em>]) OVER ( [PARTITION BY
                                        <em class="ph i">expr</em>] ORDER BY <em class="ph i">expr</em> )</code>
                            </td>
                            <td class="entry" headers="topic30__in164369__entry__4">Provides access to more than one row of the same
                                table without doing a self join. Given a series of rows returned
                                from a query and a position of the cursor, <code class="ph codeph">lead</code>
                                provides access to a row at a given physical offset after that
                                position. If <em class="ph i">offset</em> is not specified, the default offset is
                                1. <em class="ph i">default</em> sets the value that is returned if the offset goes
                                beyond the scope of the window. If <em class="ph i">default</em> is not specified,
                                the default value is null.</td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic30__in164369__entry__1">
                                <code class="ph codeph">ntile(<em class="ph i">expr</em>)</code>
                            </td>
                            <td class="entry" headers="topic30__in164369__entry__2"><code class="ph codeph">bigint</code></td>
                            <td class="entry" headers="topic30__in164369__entry__3">
                                <code class="ph codeph">NTILE(<em class="ph i">expr</em>) OVER ( [PARTITION BY <em class="ph i">expr</em>] ORDER
                                    BY <em class="ph i">expr</em> )</code>
                            </td>
                            <td class="entry" headers="topic30__in164369__entry__4">Divides an ordered data set into a number of
                                buckets (as defined by <em class="ph i">expr</em>) and assigns a bucket number to
                                each row.</td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic30__in164369__entry__1"><code class="ph codeph">percent_rank()</code></td>
                            <td class="entry" headers="topic30__in164369__entry__2">
                                <code class="ph codeph">double precision</code>
                            </td>
                            <td class="entry" headers="topic30__in164369__entry__3">
                                <code class="ph codeph">PERCENT_RANK () OVER ( [PARTITION BY <em class="ph i">expr</em>] ORDER BY
                                        <em class="ph i">expr </em>)</code>
                            </td>
                            <td class="entry" headers="topic30__in164369__entry__4">Calculates the rank of a hypothetical row
                                    <code class="ph codeph">R</code> minus 1, divided by 1 less than the number of
                                rows being evaluated (within a window partition).</td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic30__in164369__entry__1">
                                <code class="ph codeph">rank()</code>
                            </td>
                            <td class="entry" headers="topic30__in164369__entry__2"><code class="ph codeph">bigint</code></td>
                            <td class="entry" headers="topic30__in164369__entry__3">
                                <code class="ph codeph">RANK () OVER ( [PARTITION BY <em class="ph i">expr</em>] ORDER BY <em class="ph i">expr
                                    </em>)</code>
                            </td>
                            <td class="entry" headers="topic30__in164369__entry__4">Calculates the rank of a row in an ordered group
                                of values. Rows with equal values for the ranking criteria receive
                                the same rank. The number of tied rows are added to the rank number
                                to calculate the next rank value. Ranks may not be consecutive
                                numbers in this case.</td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic30__in164369__entry__1"><code class="ph codeph">row_number()</code></td>
                            <td class="entry" headers="topic30__in164369__entry__2">
                                <code class="ph codeph">bigint</code>
                            </td>
                            <td class="entry" headers="topic30__in164369__entry__3">
                                <code class="ph codeph">ROW_NUMBER () OVER ( [PARTITION BY <em class="ph i">expr</em>] ORDER BY
                                        <em class="ph i">expr </em>)</code>
                            </td>
                            <td class="entry" headers="topic30__in164369__entry__4">Assigns a unique number to each row to which it is
                                applied (either each row in a window partition or each row of the
                                query).</td>
                        </tr>
                    </tbody></table>
<h2 id="advanced-aggregate-functions"><a class="header" href="#advanced-aggregate-functions"><a id="topic31"></a>Advanced Aggregate Functions</a></h2>
<p>The following built-in advanced aggregate functions are SynxDB extensions of the PostgreSQL database. These functions are <em>immutable</em>.</p>
<blockquote>
<p><strong>Note</strong> The SynxDB MADlib Extension for Analytics provides additional advanced functions to perform statistical analysis and machine learning with SynxDB data. See <a href="../../../analytics/madlib.html">SynxDB MADlib Extension for Analytics</a> in the <em>SynxDB Reference Guide</em>.</p>
</blockquote>
<table class="table" id="topic31__in2073121"><caption><span class="table--title-label">Table 5. </span><span class="title">Advanced Aggregate Functions</span></caption><colgroup><col style="width:23.00684070063499%"><col style="width:18.098714684499523%"><col style="width:31.2862357741035%"><col style="width:27.60820884076199%"></colgroup><thead class="thead">
                        <tr class="row">
                            <th class="entry" id="topic31__in2073121__entry__1">Function</th>
                            <th class="entry" id="topic31__in2073121__entry__2">Return Type</th>
                            <th class="entry" id="topic31__in2073121__entry__3">Full Syntax</th>
                            <th class="entry" id="topic31__in2073121__entry__4">Description</th>
                        </tr>
                    </thead><tbody class="tbody">
                        <tr class="row">
                            <td class="entry" headers="topic31__in2073121__entry__1">
                                <code class="ph codeph">MEDIAN (<em class="ph i">expr</em>)</code>
                            </td>
                            <td class="entry" headers="topic31__in2073121__entry__2">
                                <code class="ph codeph">timestamp, timestamptz, interval, float</code>
                            </td>
                            <td class="entry" headers="topic31__in2073121__entry__3">
                                <code class="ph codeph">MEDIAN (<em class="ph i">expression</em>)</code>
                                <p class="p">
                                    <em class="ph i">Example:</em>
                                </p><pre class="pre codeblock"><code>SELECT departmzent_id, MEDIAN(salary) 
  FROM employees 
GROUP BY department_id; </code></pre>
                            </td>
                            <td class="entry" headers="topic31__in2073121__entry__4">Can take a two-dimensional array as input. Treats
                                such arrays as matrices.</td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic31__in2073121__entry__1">
                                <code class="ph codeph">sum(array[])</code>
                            </td>
                            <td class="entry" headers="topic31__in2073121__entry__2">
                                <code class="ph codeph">smallint[], int[], bigint[], float[]</code>
                            </td>
                            <td class="entry" headers="topic31__in2073121__entry__3">
                                <code class="ph codeph">sum(array[[1,2],[3,4]])</code>
                                <p class="p">
                                    <em class="ph i">Example:</em>
                                </p><pre class="pre codeblock"><code>CREATE TABLE mymatrix (myvalue int[]);
INSERT INTO mymatrix 
   VALUES (array[[1,2],[3,4]]);
INSERT INTO mymatrix 
   VALUES (array[[0,1],[1,0]]);
SELECT sum(myvalue) FROM mymatrix;
 sum 
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-
 {{1,3},{4,4}}</code></pre>
                            </td>
                            <td class="entry" headers="topic31__in2073121__entry__4">Performs matrix summation. Can take as input a
                                two-dimensional array that is treated as a matrix.</td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic31__in2073121__entry__1">
                                <code class="ph codeph">pivot_sum (label[], label, expr)</code>
                            </td>
                            <td class="entry" headers="topic31__in2073121__entry__2">
                                <code class="ph codeph">int[], bigint[], float[]</code>
                            </td>
                            <td class="entry" headers="topic31__in2073121__entry__3">
                                <code class="ph codeph">pivot_sum( array['A1','A2'], attr, value)</code>
                            </td>
                            <td class="entry" headers="topic31__in2073121__entry__4">A pivot aggregation using sum to resolve duplicate
                                entries.</td>
                        </tr>
                        <tr class="row">
                            <td class="entry" headers="topic31__in2073121__entry__1">
                                <code class="ph codeph">unnest (array[])</code>
                            </td>
                            <td class="entry" headers="topic31__in2073121__entry__2">set of <code class="ph codeph">anyelement</code></td>
                            <td class="entry" headers="topic31__in2073121__entry__3">
                                <code class="ph codeph">unnest( array['one', 'row', 'per', 'item'])</code>
                            </td>
                            <td class="entry" headers="topic31__in2073121__entry__4">Transforms a one dimensional array into rows.
                                Returns a set of <code class="ph codeph">anyelement</code>, a polymorphic <a class="xref" href="https://www.postgresql.org/docs/9.4/datatype-pseudo.html" target="_blank" rel="external noopener"><span class="ph">pseudo-type</span></a> in
                                PostgreSQL.</td>
                        </tr>
                    </tbody></table>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../../admin_guide/query/topics/CTE-query.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../../admin_guide/query/topics/json-data.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../../admin_guide/query/topics/CTE-query.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../../admin_guide/query/topics/json-data.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../../elasticlunr.min.js"></script>
        <script src="../../../mark.min.js"></script>
        <script src="../../../searcher.js"></script>

        <script src="../../../clipboard.min.js"></script>
        <script src="../../../highlight.js"></script>
        <script src="../../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
