<!DOCTYPE HTML>
<html lang="en" class="ayu sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Configuring Client Authentication - SynxDB 2 Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">SynxDB 2 Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                        &nbsp;&nbsp;&nbsp;&nbsp;
                        <a href="https://www.synxdata.com/"><img id="fa fa-print" src="../SYNX-Text-and-Circular-Logo-142x28-White-text-Black-background.png" alt="Synx Data Labs Logo"/></a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="configuring-client-authentication"><a class="header" href="#configuring-client-authentication">Configuring Client Authentication</a></h1>
<p>This topic explains how to configure client connections and authentication for SynxDB.</p>
<p>When a SynxDB system is first initialized, the system contains one predefined <em>superuser</em> role. This role will have the same name as the operating system user who initialized the SynxDB system. This role is referred to as <code>gpadmin</code>. By default, the system is configured to only allow local connections to the database from the <code>gpadmin</code> role. If you want to allow any other roles to connect, or if you want to allow connections from remote hosts, you have to configure SynxDB to allow such connections. This section explains how to configure client connections and authentication to SynxDB.</p>
<ul>
<li><strong><a href="ldap.html">Using LDAP Authentication with TLS/SSL</a></strong><br />
You can control access to SynxDB with an LDAP server and, optionally, secure the connection with encryption by adding parameters to pg_hba.conf file entries.</li>
<li><strong><a href="kerberos.html">Using Kerberos Authentication</a></strong><br />
You can control access to SynxDB with a Kerberos authentication server.</li>
<li><strong><a href="kerberos-lin-client.html">Configuring Kerberos for Linux Clients</a></strong><br />
You can configure Linux client applications to connect to a SynxDB system that is configured to authenticate with Kerberos.</li>
<li><strong><a href="kerberos-win-client.html">Configuring Kerberos For Windows Clients</a></strong><br />
You can configure Microsoft Windows client applications to connect to a SynxDB system that is configured to authenticate with Kerberos.</li>
</ul>
<h2 id="allowing-connections-to-synxdb"><a class="header" href="#allowing-connections-to-synxdb"><a id="topic2"></a>Allowing Connections to SynxDB</a></h2>
<p>Client access and authentication is controlled by the standard PostgreSQL host-based authentication file, pg_hba.conf. For detailed information about this file, see <a href="https://www.postgresql.org/docs/9.4/auth-pg-hba-conf.html">The pg_hba.conf File</a> in the PostgreSQL documentation.</p>
<p>In SynxDB, the pg_hba.conf file of the master instance controls client access and authentication to your SynxDB system. The SynxDB segments also have pg_hba.conf files, but these are already correctly configured to allow only client connections from the master host. The segments never accept outside client connections, so there is no need to alter the <code>pg_hba.conf</code> file on segments.</p>
<p>The general format of the pg_hba.conf file is a set of records, one per line. SynxDB ignores blank lines and any text after the <code>#</code> comment character. A record consists of a number of fields that are separated by spaces or tabs. Fields can contain white space if the field value is quoted. Records cannot be continued across lines. Each remote client access record has the following format:</p>
<pre><code>host   database   role   address   authentication-method
</code></pre>
<p>Each UNIX-domain socket access record is in this format:</p>
<pre><code>local   database   role   authentication-method
</code></pre>
<p>The following table describes meaning of each field.</p>
<table class="table" id="topic2__ip141709"><caption><span class="table--title-label">Table 1. </span><span class="title">pg_hba.conf Fields</span></caption><colgroup><col style="width:25%"><col style="width:75%"></colgroup><thead class="thead">
            <tr class="row">
              <th class="entry" id="topic2__ip141709__entry__1">Field</th>
              <th class="entry" id="topic2__ip141709__entry__2">Description</th>
            </tr>
          </thead><tbody class="tbody">
            <tr class="row">
              <td class="entry" headers="topic2__ip141709__entry__1">local</td>
              <td class="entry" headers="topic2__ip141709__entry__2">Matches connection attempts using UNIX-domain sockets. Without a
                record of this type, UNIX-domain socket connections are disallowed.</td>
            </tr>
            <tr class="row">
              <td class="entry" headers="topic2__ip141709__entry__1">host</td>
              <td class="entry" headers="topic2__ip141709__entry__2">Matches connection attempts made using TCP/IP. Remote TCP/IP
                connections will not be possible unless the server is started with an appropriate
                value for the <code class="ph codeph">listen_addresses</code> server configuration
                parameter.</td>
            </tr>
            <tr class="row">
              <td class="entry" headers="topic2__ip141709__entry__1">hostssl</td>
              <td class="entry" headers="topic2__ip141709__entry__2">Matches connection attempts made using TCP/IP, but only when the
                connection is made with SSL encryption. SSL must be enabled at server start time by
                setting the <code class="ph codeph">ssl</code> server configuration parameter. </td>
            </tr>
            <tr class="row">
              <td class="entry" headers="topic2__ip141709__entry__1">hostnossl</td>
              <td class="entry" headers="topic2__ip141709__entry__2">Matches connection attempts made over TCP/IP that do not use
                SSL.</td>
            </tr>
            <tr class="row">
              <td class="entry" headers="topic2__ip141709__entry__1">database</td>
              <td class="entry" headers="topic2__ip141709__entry__2">Specifies which database names this record matches. The value
                  <code class="ph codeph">all</code> specifies that it matches all databases. Multiple database
                names can be supplied by separating them with commas. A separate file containing
                database names can be specified by preceding the file name with a
                <code class="ph codeph">@</code>.</td>
            </tr>
            <tr class="row">
              <td class="entry" headers="topic2__ip141709__entry__1">role</td>
              <td class="entry" headers="topic2__ip141709__entry__2">Specifies which database role names this record matches. The
                value <code class="ph codeph">all</code> specifies that it matches all roles. If the specified
                role is a group and you want all members of that group to be included, precede the
                role name with a <code class="ph codeph">+</code>. Multiple role names can be supplied by
                separating them with commas. A separate file containing role names can be specified
                by preceding the file name with a <code class="ph codeph">@</code>.</td>
            </tr>
            <tr class="row">
              <td class="entry" headers="topic2__ip141709__entry__1">address</td>
              <td class="entry" headers="topic2__ip141709__entry__2">Specifies the client machine addresses that this record matches.
                This field can contain an IP address, an IP address range, or a host name. <p class="p">An IP
                  address range is specified using standard numeric notation for the range's
                  starting address, then a slash (<code class="ph codeph">/</code>) and a CIDR mask length. The
                  mask length indicates the number of high-order bits of the client IP address that
                  must match. Bits to the right of this should be zero in the given IP address.
                  There must not be any white space between the IP address, the <code class="ph codeph">/</code>,
                  and the CIDR mask length.</p><p class="p">Typical examples of an IPv4 address range
                  specified this way are <code class="ph codeph">172.20.143.89/32</code> for a single host, or
                    <code class="ph codeph">172.20.143.0/24</code> for a small network, or
                    <code class="ph codeph">10.6.0.0/16</code> for a larger one. An IPv6 address range might look
                  like <code class="ph codeph">::1/128</code> for a single host (in this case the IPv6 loopback
                  address) or <code class="ph codeph">fe80::7a31:c1ff:0000:0000/96</code> for a small network.
                    <code class="ph codeph">0.0.0.0/0</code> represents all IPv4 addresses, and
                    <code class="ph codeph">::0/0</code> represents all IPv6 addresses. To specify a single host,
                  use a mask length of 32 for IPv4 or 128 for IPv6. In a network address, do not
                  omit trailing zeroes.</p><div class="p">An entry given in IPv4 format will match only IPv4
                  connections, and an entry given in IPv6 format will match only IPv6 connections,
                  even if the represented address is in the IPv4-in-IPv6 range.
                  <div class="note note note_note"><span class="note__title">Note:</span> Entries in IPv6 format will be rejected if the host system C library does
                    not have support for IPv6 addresses.</div></div><p class="p">If a host name is specified
                  (an address that is not an IP address or IP range is treated as a host name), that
                  name is compared with the result of a reverse name resolution of the client IP
                  address (for example, reverse DNS lookup, if DNS is used). Host name comparisons
                  are case insensitive. If there is a match, then a forward name resolution (for
                  example, forward DNS lookup) is performed on the host name to check whether any of
                  the addresses it resolves to are equal to the client IP address. If both
                  directions match, then the entry is considered to match. </p><p class="p">Some host name
                  databases allow associating an IP address with multiple host names, but the
                  operating system only returns one host name when asked to resolve an IP address.
                  The host name that is used in <code class="ph codeph">pg_hba.conf</code> must be the one that
                  the address-to-name resolution of the client IP address returns, otherwise the
                  line will not be considered a match. </p><p class="p">When host names are specified in
                    <code class="ph codeph">pg_hba.conf</code>, you should ensure that name resolution is
                  reasonably fast. It can be of advantage to set up a local name resolution cache
                  such as <code class="ph codeph">nscd</code>. Also, you can enable the server configuration
                  parameter <code class="ph codeph">log_hostname</code> to see the client host name instead of the
                  IP address in the log. </p></td>
            </tr>
            <tr class="row">
              <td class="entry" headers="topic2__ip141709__entry__1">IP-address<p class="p">IP-mask</p></td>
              <td class="entry" headers="topic2__ip141709__entry__2">These fields can be used as an alternative to the CIDR address
                notation. Instead of specifying the mask length, the actual mask is specified in a
                separate column. For example, <code class="ph codeph">255.0.0.0</code> represents an IPv4 CIDR
                mask length of 8, and <code class="ph codeph">255.255.255.255</code> represents a CIDR mask length
                of 32.</td>
            </tr>
            <tr class="row">
              <td class="entry" headers="topic2__ip141709__entry__1">authentication-method</td>
              <td class="entry" headers="topic2__ip141709__entry__2">Specifies the authentication method to use when connecting.
                SynxDB supports the <a class="xref" href="https://www.postgresql.org/docs/9.4/auth-methods.html" target="_blank" rel="external noopener">authentication methods</a> supported by PostgreSQL 9.4.</td>
            </tr>
          </tbody></table>
<blockquote>
<p><strong>Caution</strong> For a more secure system, consider removing records for remote connections that use trust authentication from the <code>pg_hba.conf</code> file. Trust authentication grants any user who can connect to the server access to the database using any role they specify. You can safely replace trust authentication with ident authentication for local UNIX-socket connections. You can also use ident authentication for local and remote TCP clients, but the client host must be running an ident service and you must trust the integrity of that machine.</p>
</blockquote>
<h3 id="editing-the-pg_hbaconf-file"><a class="header" href="#editing-the-pg_hbaconf-file"><a id="topic3"></a>Editing the pg_hba.conf File</a></h3>
<p>Initially, the <code>pg_hba.conf</code> file is set up with generous permissions for the gpadmin user and no database access for other SynxDB roles. You will need to edit the <code>pg_hba.conf</code> file to enable users’ access to databases and to secure the gpadmin user. Consider removing entries that have trust authentication, since they allow anyone with access to the server to connect with any role they choose. For local (UNIX socket) connections, use ident authentication, which requires the operating system user to match the role specified. For local and remote TCP connections, ident authentication requires the client’s host to run an indent service. You can install an ident service on the master host and then use ident authentication for local TCP connections, for example <code>127.0.0.1/28</code>. Using ident authentication for remote TCP connections is less secure because it requires you to trust the integrity of the ident service on the client’s host.</p>
<p>This example shows how to edit the pg_hba.conf file of the master to allow remote client access to all databases from all roles using encrypted password authentication.</p>
<h4 id="editing-pg_hbaconf"><a class="header" href="#editing-pg_hbaconf"><a id="ip144328"></a>Editing pg_hba.conf</a></h4>
<ol>
<li>
<p>Open the file $MASTER_DATA_DIRECTORY/pg_hba.conf in a text editor.</p>
</li>
<li>
<p>Add a line to the file for each type of connection you want to allow. Records are read sequentially, so the order of the records is significant. Typically, earlier records will have tight connection match parameters and weaker authentication methods, while later records will have looser match parameters and stronger authentication methods. For example:</p>
<pre><code># allow the gpadmin user local access to all databases
# using ident authentication
local   all   gpadmin   ident         sameuser
host    all   gpadmin   127.0.0.1/32  ident
host    all   gpadmin   ::1/128       ident
# allow the 'dba' role access to any database from any
# host with IP address 192.168.x.x and use md5 encrypted
# passwords to authenticate the user
# Note that to use SHA-256 encryption, replace md5 with
# password in the line below
host    all   dba   192.168.0.0/32  md5
# allow all roles access to any database from any
# host and use ldap to authenticate the user. SynxDB role
# names must match the LDAP common name.
host    all   all   192.168.0.0/32  ldap ldapserver=usldap1 ldapport=1389 ldapprefix="cn=" ldapsuffix=",ou=People,dc=company,dc=com"
</code></pre>
</li>
<li>
<p>Save and close the file.</p>
</li>
<li>
<p>Reload the pg_hba.conf configuration file for your changes to take effect:</p>
<pre><code>$ gpstop -u
</code></pre>
</li>
</ol>
<blockquote>
<p><strong>Note</strong> Note that you can also control database access by setting object privileges as described in <a href="roles_privs.html">Managing Object Privileges</a>. The pg_hba.conf file just controls who can initiate a database session and how those connections are authenticated.</p>
</blockquote>
<h2 id="limiting-concurrent-connections"><a class="header" href="#limiting-concurrent-connections"><a id="topic4"></a>Limiting Concurrent Connections</a></h2>
<p>SynxDB allocates some resources on a per-connection basis, so setting the maximum number of connections allowed is recommended.</p>
<p>To limit the number of active concurrent sessions to your SynxDB system, you can configure the <code>max_connections</code> server configuration parameter. This is a <em>local</em> parameter, meaning that you must set it in the <code>postgresql.conf</code> file of the master, the standby master, and each segment instance (primary and mirror). The recommended value of <code>max_connections</code> on segments is 5-10 times the value on the master.</p>
<p>When you set <code>max_connections</code>, you must also set the dependent parameter <code>max_prepared_transactions</code>. This value must be at least as large as the value of <code>max_connections</code> on the master, and segment instances should be set to the same value as the master.</p>
<p>For example:</p>
<ul>
<li>
<p>In <code>$MASTER_DATA_DIRECTORY/postgresql.conf</code> (including standby master):</p>
<pre><code>max_connections=100
max_prepared_transactions=100

</code></pre>
</li>
<li>
<p>In <code>SEGMENT_DATA_DIRECTORY/postgresql.conf</code> for all segment instances:</p>
<pre><code>max_connections=500
max_prepared_transactions=100

</code></pre>
</li>
</ul>
<p>The following steps set the parameter values with the SynxDB utility <code>gpconfig</code>.</p>
<p>For information about <code>gpconfig</code>, see the <em>SynxDB Utility Guide</em>.</p>
<h3 id="to-change-the-number-of-allowed-connections"><a class="header" href="#to-change-the-number-of-allowed-connections"><a id="ip142411"></a>To change the number of allowed connections</a></h3>
<ol>
<li>
<p>Log into the SynxDB master host as the SynxDB administrator and source the file <code>$GPHOME/synxdb_path.sh</code>.</p>
</li>
<li>
<p>Set the value of the <code>max_connections</code> parameter. This <code>gpconfig</code> command sets the value on the segments to 1000 and the value on the master to 200.</p>
<pre><code>$ gpconfig -c max_connections -v 1000 -m 200

</code></pre>
<p>The value on the segments must be greater than the value on the master. The recommended value of <code>max_connections</code> on segments is 5-10 times the value on the master.</p>
</li>
<li>
<p>Set the value of the <code>max_prepared_transactions</code> parameter. This <code>gpconfig</code> command sets the value to 200 on the master and all segments.</p>
<pre><code>$ gpconfig -c max_prepared_transactions -v 200

</code></pre>
<p>The value of <code>max_prepared_transactions</code> must be greater than or equal to <code>max_connections</code> on the master.</p>
</li>
<li>
<p>Stop and restart your SynxDB system.</p>
<pre><code>$ gpstop -r

</code></pre>
</li>
<li>
<p>You can check the value of parameters on the master and segments with the <code>gpconfig</code> <code>-s</code> option. This <code>gpconfig</code> command displays the values of the <code>max_connections</code> parameter.</p>
<pre><code>$ gpconfig -s max_connections

</code></pre>
</li>
</ol>
<blockquote>
<p><strong>Note</strong> Raising the values of these parameters may cause SynxDB to request more shared memory. To mitigate this effect, consider decreasing other memory-related parameters such as <code>gp_cached_segworkers_threshold</code>.</p>
</blockquote>
<h2 id="encrypting-clientserver-connections"><a class="header" href="#encrypting-clientserver-connections"><a id="topic5"></a>Encrypting Client/Server Connections</a></h2>
<p>Enable SSL for client connections to SynxDB to encrypt the data passed over the network between the client and the database.</p>
<p>SynxDB has native support for SSL connections between the client and the master server. SSL connections prevent third parties from snooping on the packets, and also prevent man-in-the-middle attacks. SSL should be used whenever the client connection goes through an insecure link, and must be used whenever client certificate authentication is used.</p>
<p>Enabling SynxDB in SSL mode requires the following items.</p>
<ul>
<li>
<p>OpenSSL installed on both the client and the master server hosts (master and standby master).</p>
</li>
<li>
<p>The SSL files server.key (server private key) and server.crt (server certificate) should be correctly generated for the master host and standby master host.</p>
<ul>
<li>The private key should not be protected with a passphrase. The server does not prompt for a passphrase for the private key, and SynxDB start up fails with an error if one is required.</li>
<li>On a production system, there should be a key and certificate pair for the master host and a pair for the standby master host with a subject CN (Common Name) for the master host and standby master host.
A self-signed certificate can be used for testing, but a certificate signed by a certificate authority (CA) should be used in production, so the client can verify the identity of the server. Either a global or local CA can be used. If all the clients are local to the organization, a local CA is recommended.</li>
</ul>
</li>
<li>
<p>Ensure that SynxDB can access server.key and server.crt, and any additional authentication files such as <code>root.crt</code> (for trusted certificate authorities). When starting in SSL mode, the SynxDB master looks for server.key and server.crt. As the default, SynxDB does not start if the files are not in the master data directory (<code>$MASTER_DATA_DIRECTORY</code>). Also, if you use other SSL authentication files such as <code>root.crt</code> (trusted certificate authorities), the files must be on the master host.</p>
<p>If SynxDB master mirroring is enabled with SSL client authentication, SSL authentication files must be on both the master host and standby master host and <em>should not be placed</em> in the default directory <code>$MASTER_DATA_DIRECTORY</code>. When master mirroring is enabled, an <code>initstandby</code> operation copies the contents of the <code>$MASTER_DATA_DIRECTORY</code> from the master to the standby master and the incorrect SSL key, and cert files (the master files, and not the standby master files) will prevent standby master start up.</p>
<p>You can specify a different directory for the location of the SSL server files with the <code>postgresql.conf</code> parameters <code>sslcert</code>, <code>sslkey</code>, <code>sslrootcert</code>, and <code>sslcrl</code>. For more information about the parameters, see <a href="../security-guide/topics/Authenticate.html">SSL Client Authentication</a> in the <em>Security Configuration Guide</em>.</p>
</li>
</ul>
<p>SynxDB can be started with SSL enabled by setting the server configuration parameter <code>ssl=on</code> in the <code>postgresql.conf</code> file on the master and standby master hosts. This <code>gpconfig</code> command sets the parameter:</p>
<pre><code>gpconfig -c ssl -m on -v off
</code></pre>
<p>Setting the parameter requires a server restart. This command restarts the system: <code>gpstop -ra</code>.</p>
<h3 id="creating-a-self-signed-certificate-without-a-passphrase-for-testing-only"><a class="header" href="#creating-a-self-signed-certificate-without-a-passphrase-for-testing-only"><a id="topic6"></a>Creating a Self-signed Certificate without a Passphrase for Testing Only</a></h3>
<p>To create a quick self-signed certificate for the server for testing, use the following OpenSSL command:</p>
<pre><code># openssl req -new -text -out server.req

</code></pre>
<p>Enter the information requested by the prompts. Be sure to enter the local host name as <em>Common Name</em>. The challenge password can be left blank.</p>
<p>The program will generate a key that is passphrase protected, and does not accept a passphrase that is less than four characters long.</p>
<p>To use this certificate with SynxDB, remove the passphrase with the following commands:</p>
<pre><code># openssl rsa -in privkey.pem -out server.key
# rm privkey.pem
</code></pre>
<p>Enter the old passphrase when prompted to unlock the existing key.</p>
<p>Then, enter the following command to turn the certificate into a self-signed certificate and to copy the key and certificate to a location where the server will look for them.</p>
<pre><code># openssl req -x509 -in server.req -text -key server.key -out server.crt
</code></pre>
<p>Finally, change the permissions on the key with the following command. The server will reject the file if the permissions are less restrictive than these.</p>
<pre><code># chmod og-rwx server.key
</code></pre>
<p>For more details on how to create your server private key and certificate, refer to the <a href="https://www.openssl.org/docs/">OpenSSL documentation</a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../admin_guide/partIII.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../admin_guide/ldap.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../admin_guide/partIII.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../admin_guide/ldap.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
