<!DOCTYPE HTML>
<html lang="en" class="ayu sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Creating and Using Sequences - SynxDB 2 Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">SynxDB 2 Documentation</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                        &nbsp;&nbsp;&nbsp;&nbsp;
                        <a href="https://www.synxdata.com/"><img id="fa fa-print" src="../../SYNX-Text-and-Circular-Logo-142x28-White-text-Black-background.png" alt="Synx Data Labs Logo"/></a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="creating-and-using-sequences"><a class="header" href="#creating-and-using-sequences">Creating and Using Sequences</a></h1>
<p>A SynxDB sequence object is a special single row table that functions as a number generator. You can use a sequence to generate unique integer identifiers for a row that you add to a table. Declaring a column of type <code>SERIAL</code> implicitly creates a sequence counter for use in that table column.</p>
<p>SynxDB provides commands to create, alter, and drop a sequence. SynxDB also provides built-in functions to return the next value in the sequence (<code>nextval()</code>) or to set the sequence to a specific start value (<code>setval()</code>).</p>
<blockquote>
<p><strong>Note</strong> The PostgreSQL <code>currval()</code> and <code>lastval()</code> sequence functions are not supported in SynxDB.</p>
</blockquote>
<p>Attributes of a sequence object include the name of the sequence, its increment value, and the last, minimum, and maximum values of the sequence counter. Sequences also have a special boolean attribute named <code>is_called</code> that governs the auto-increment behavior of a <code>nextval()</code> operation on the sequence counter. When a sequenceâ€™s <code>is_called</code> attribute is <code>true</code>, <code>nextval()</code> increments the sequence counter before returning the value. When the <code>is_called</code> attribute value of a sequence is <code>false</code>, <code>nextval()</code> does not increment the counter before returning the value.</p>
<h2 id="creating-a-sequence"><a class="header" href="#creating-a-sequence"><a id="topic87"></a>Creating a Sequence</a></h2>
<p>The <a href="../../ref_guide/sql_commands/CREATE_SEQUENCE.html">CREATE SEQUENCE</a> command creates and initializes a sequence with the given sequence name and optional start value. The sequence name must be distinct from the name of any other sequence, table, index, or view in the same schema. For example:</p>
<pre><code>CREATE SEQUENCE myserial START 101;

</code></pre>
<p>When you create a new sequence, SynxDB sets the sequence <code>is_called</code> attribute to <code>false</code>. Invoking <code>nextval()</code> on a newly-created sequence does not increment the sequence counter, but returns the sequence start value and sets <code>is_called</code> to <code>true</code>.</p>
<h2 id="using-a-sequence"><a class="header" href="#using-a-sequence"><a id="topic88"></a>Using a Sequence</a></h2>
<p>After you create a sequence with the <code>CREATE SEQUENCE</code> command, you can examine the sequence and use the sequence built-in functions.</p>
<h3 id="examining-sequence-attributes"><a class="header" href="#examining-sequence-attributes"><a id="exseq"></a>Examining Sequence Attributes</a></h3>
<p>To examine the current attributes of a sequence, query the sequence directly. For example, to examine a sequence named <code>myserial</code>:</p>
<pre><code>SELECT * FROM myserial;

</code></pre>
<h3 id="returning-the-next-sequence-counter-value"><a class="header" href="#returning-the-next-sequence-counter-value"><a id="retnex"></a>Returning the Next Sequence Counter Value</a></h3>
<p>You can invoke the <code>nextval()</code> built-in function to return and use the next value in a sequence. The following command inserts the next value of the sequence named <code>myserial</code> into the first column of a table named <code>vendors</code>:</p>
<pre><code>INSERT INTO vendors VALUES (nextval('myserial'), 'acme');

</code></pre>
<p><code>nextval()</code> uses the sequenceâ€™s <code>is_called</code> attribute value to determine whether or not to increment the sequence counter before returning the value. <code>nextval()</code> advances the counter when <code>is_called</code> is <code>true</code>. <code>nextval()</code> sets the sequence <code>is_called</code> attribute to <code>true</code> before returning.</p>
<p>A <code>nextval()</code> operation is never rolled back. A fetched value is considered used, even if the transaction that performed the <code>nextval()</code> fails. This means that failed transactions can leave unused holes in the sequence of assigned values.</p>
<blockquote>
<p><strong>Note</strong> You cannot use the <code>nextval()</code> function in <code>UPDATE</code> or <code>DELETE</code> statements if mirroring is enabled in SynxDB.</p>
</blockquote>
<h3 id="setting-the-sequence-counter-value"><a class="header" href="#setting-the-sequence-counter-value"><a id="setseq"></a>Setting the Sequence Counter Value</a></h3>
<p>You can use the SynxDB <code>setval()</code> built-in function to set the counter value for a sequence. For example, the following command sets the counter value of the sequence named <code>myserial</code> to <code>201</code>:</p>
<pre><code>SELECT setval('myserial', 201);

</code></pre>
<p><code>setval()</code> has two function signatures: <code>setval(sequence, start_val)</code> and <code>setval(sequence, start_val, is_called)</code>. The default behaviour of <code>setval(sequence, start_val)</code> sets the sequence <code>is_called</code> attribute value to <code>true</code>.</p>
<p>If you do not want the sequence counter advanced on the next <code>nextval()</code> call, use the <code>setval(sequence, start_val, is_called)</code> function signature, passing a <code>false</code> argument:</p>
<pre><code>SELECT setval('myserial', 201, false);

</code></pre>
<p><code>setval()</code> operations are never rolled back.</p>
<h2 id="altering-a-sequence"><a class="header" href="#altering-a-sequence"><a id="topic89"></a>Altering a Sequence</a></h2>
<p>The <a href="../../ref_guide/sql_commands/ALTER_SEQUENCE.html">ALTER SEQUENCE</a> command changes the attributes of an existing sequence. You can alter the sequence start, minimum, maximum, and increment values. You can also restart the sequence at the start value or at a specified value.</p>
<p>Any parameters not set in the <code>ALTER SEQUENCE</code> command retain their prior settings.</p>
<p><code>ALTER SEQUENCE sequence START WITH start_value</code> sets the sequenceâ€™s <code>start_value</code> attribute to the new starting value. It has no effect on the <code>last_value</code> attribute or the value returned by the <code>nextval(sequence)</code> function.</p>
<p><code>ALTER SEQUENCE sequence RESTART</code> resets the sequenceâ€™s <code>last_value</code> attribute to the current value of the <code>start_value</code> attribute and the <code>is_called</code> attribute to <code>false</code>. The next call to the <code>nextval(sequence)</code> function returns <code>start_value</code>.</p>
<p><code>ALTER SEQUENCE sequence RESTART WITH restart_value</code> sets the sequenceâ€™s <code>last_value</code> attribute to the new value and the <code>is_called</code> attribute to <code>false</code>. The next call to the <code>nextval(sequence)</code> returns <code>restart_value</code>. This is the equivalent of calling <code>setval(sequence, restart_value, false)</code>.</p>
<p>The following command restarts the sequence named <code>myserial</code> at value <code>105</code>:</p>
<pre><code>ALTER SEQUENCE myserial RESTART WITH 105;

</code></pre>
<h2 id="dropping-a-sequence"><a class="header" href="#dropping-a-sequence"><a id="topic90"></a>Dropping a Sequence</a></h2>
<p>The <a href="../../ref_guide/sql_commands/DROP_SEQUENCE.html">DROP SEQUENCE</a> command removes a sequence. For example, the following command removes the sequence named <code>myserial</code>:</p>
<pre><code>DROP SEQUENCE myserial;

</code></pre>
<h2 id="specifying-a-sequence-as-the-default-value-for-a-column"><a class="header" href="#specifying-a-sequence-as-the-default-value-for-a-column"><a id="topic91"></a>Specifying a Sequence as the Default Value for a Column</a></h2>
<p>You can reference a sequence directly in the <a href="../../ref_guide/sql_commands/CREATE_TABLE.html">CREATE TABLE</a> command in addition to using the <code>SERIAL</code> or <code>BIGSERIAL</code> types. For example:</p>
<pre><code>CREATE TABLE tablename ( id INT4 DEFAULT nextval('myserial'), name text );

</code></pre>
<p>You can also alter a table column to set its default value to a sequence counter:</p>
<pre><code>ALTER TABLE tablename ALTER COLUMN id SET DEFAULT nextval('myserial');

</code></pre>
<h2 id="sequence-wraparound"><a class="header" href="#sequence-wraparound"><a id="topic92"></a>Sequence Wraparound</a></h2>
<p>By default, a sequence does not wrap around. That is, when a sequence reaches the max value (<code>+32767</code> for <code>SMALLSERIAL</code>, <code>+2147483647</code> for <code>SERIAL</code>, <code>+9223372036854775807</code> for <code>BIGSERIAL</code>), every subsequent <code>nextval()</code> call produces an error. You can alter a sequence to make it cycle around and start at <code>1</code> again:</p>
<pre><code>ALTER SEQUENCE myserial CYCLE;
</code></pre>
<p>You can also specify the wraparound behaviour when you create the sequence:</p>
<pre><code>CREATE SEQUENCE myserial CYCLE;
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../admin_guide/ddl/ddl-partition.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../admin_guide/ddl/ddl-index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../admin_guide/ddl/ddl-partition.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../admin_guide/ddl/ddl-index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
