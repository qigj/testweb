<!DOCTYPE HTML>
<html lang="en" class="ayu sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Creating and Managing Tablespaces - SynxDB 2 Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">SynxDB 2 Documentation</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                        &nbsp;&nbsp;&nbsp;&nbsp;
                        <a href="https://www.synxdata.com/"><img id="fa fa-print" src="../../SYNX-Text-and-Circular-Logo-142x28-White-text-Black-background.png" alt="Synx Data Labs Logo"/></a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="creating-and-managing-tablespaces"><a class="header" href="#creating-and-managing-tablespaces">Creating and Managing Tablespaces</a></h1>
<p>Tablespaces allow database administrators to have multiple file systems per machine and decide how to best use physical storage to store database objects. Tablespaces allow you to assign different storage for frequently and infrequently used database objects or to control the I/O performance on certain database objects. For example, place frequently-used tables on file systems that use high performance solid-state drives (SSD), and place other tables on standard hard drives.</p>
<p>A tablespace requires a host file system location to store its database files. In SynxDB, the file system location must exist on all hosts including the hosts running the master, standby master, each primary segment, and each mirror segment.</p>
<p>A tablespace is SynxDB system object (a global object), you can use a tablespace from any database if you have appropriate privileges.</p>
<blockquote>
<p><strong>Note</strong> SynxDB does not support different tablespace locations for a primary-mirror pair with the same content ID. It is only possible to configure different locations for different content IDs. Do not modify symbolic links under the <code>pg_tblspc</code> directory so that primary-mirror pairs point to different file locations; this will lead to erroneous behavior.</p>
</blockquote>
<h2 id="creating-a-tablespace"><a class="header" href="#creating-a-tablespace"><a id="topic13"></a>Creating a Tablespace</a></h2>
<p>The <code>CREATE TABLESPACE</code> command defines a tablespace. For example:</p>
<pre><code>CREATE TABLESPACE fastspace LOCATION '/fastdisk/gpdb';

</code></pre>
<p>Database superusers define tablespaces and grant access to database users with the <code>GRANT``CREATE</code>command. For example:</p>
<pre><code>GRANT CREATE ON TABLESPACE fastspace TO admin;

</code></pre>
<h2 id="using-a-tablespace-to-store-database-objects"><a class="header" href="#using-a-tablespace-to-store-database-objects"><a id="topic14"></a>Using a Tablespace to Store Database Objects</a></h2>
<p>Users with the <code>CREATE</code> privilege on a tablespace can create database objects in that tablespace, such as tables, indexes, and databases. The command is:</p>
<pre><code>CREATE TABLE tablename(options) TABLESPACE spacename

</code></pre>
<p>For example, the following command creates a table in the tablespace <em>space1</em>:</p>
<pre><code>CREATE TABLE foo(i int) TABLESPACE space1;

</code></pre>
<p>You can also use the <code>default_tablespace</code> parameter to specify the default tablespace for <code>CREATE TABLE</code> and <code>CREATE INDEX</code> commands that do not specify a tablespace:</p>
<pre><code>SET default_tablespace = space1;
CREATE TABLE foo(i int);

</code></pre>
<p>There is also the <code>temp_tablespaces</code> configuration parameter, which determines the placement of temporary tables and indexes, as well as temporary files that are used for purposes such as sorting large data sets. This can be a comma-separate list of tablespace names, rather than only one, so that the load associated with temporary objects can be spread over multiple tablespaces. A random member of the list is picked each time a temporary object is to be created.</p>
<p>The tablespace associated with a database stores that database’s system catalogs, temporary files created by server processes using that database, and is the default tablespace selected for tables and indexes created within the database, if no <code>TABLESPACE</code> is specified when the objects are created. If you do not specify a tablespace when you create a database, the database uses the same tablespace used by its template database.</p>
<p>You can use a tablespace from any database in the SynxDB system if you have appropriate privileges.</p>
<h2 id="viewing-existing-tablespaces"><a class="header" href="#viewing-existing-tablespaces"><a id="topic15"></a>Viewing Existing Tablespaces</a></h2>
<p>Every SynxDB system has the following default tablespaces.</p>
<ul>
<li><code>pg_global</code> for shared system catalogs.</li>
<li><code>pg_default</code>, the default tablespace. Used by the <em>template1</em> and <em>template0</em> databases.</li>
</ul>
<p>These tablespaces use the default system location, the data directory locations created at system initialization.</p>
<p>To see tablespace information, use the <code>pg_tablespace</code> catalog table to get the object ID (OID) of the tablespace and then use <code>gp_tablespace_location()</code> function to display the tablespace directories. This is an example that lists one user-defined tablespace, <code>myspace</code>:</p>
<pre><code>SELECT oid, * FROM pg_tablespace ;

  oid  |  spcname   | spcowner | spcacl | spcoptions
-------+------------+----------+--------+------------
  1663 | pg_default |       10 |        |
  1664 | pg_global  |       10 |        |
 16391 | myspace    |       10 |        |
(3 rows)

</code></pre>
<p>The OID for the tablespace <code>myspace</code> is <code>16391</code>. Run <code>gp_tablespace_location()</code> to display the tablespace locations for a system that consists of two segment instances and the master.</p>
<pre><code># SELECT * FROM gp_tablespace_location(16391);
 gp_segment_id |    tblspc_loc
---------------+------------------
             0 | /data/mytblspace
             1 | /data/mytblspace
            -1 | /data/mytblspace
(3 rows)

</code></pre>
<p>This query uses <code>gp_tablespace_location()</code> the <code>gp_segment_configuration</code> catalog table to display segment instance information with the file system location for the <code>myspace</code> tablespace.</p>
<pre><code>WITH spc AS (SELECT * FROM  gp_tablespace_location(16391))
  SELECT seg.role, spc.gp_segment_id as seg_id, seg.hostname, seg.datadir, tblspc_loc 
    FROM spc, gp_segment_configuration AS seg 
    WHERE spc.gp_segment_id = seg.content ORDER BY seg_id;

</code></pre>
<p>This is information for a test system that consists of two segment instances and the master on a single host.</p>
<pre><code> role | seg_id | hostname |       datadir        |    tblspc_loc
------+--------+----------+----------------------+------------------
 p    |     -1 | testhost | /data/master/gpseg-1 | /data/mytblspace
 p    |      0 | testhost | /data/data1/gpseg0   | /data/mytblspace
 p    |      1 | testhost | /data/data2/gpseg1   | /data/mytblspace
(3 rows)
</code></pre>
<h2 id="dropping-tablespaces"><a class="header" href="#dropping-tablespaces"><a id="topic16"></a>Dropping Tablespaces</a></h2>
<p>To drop a tablespace, you must be the tablespace owner or a superuser. You cannot drop a tablespace until all objects in all databases using the tablespace are removed.</p>
<p>The <code>DROP TABLESPACE</code> command removes an empty tablespace.</p>
<blockquote>
<p><strong>Note</strong> You cannot drop a tablespace if it is not empty or if it stores temporary or transaction files.</p>
</blockquote>
<h2 id="moving-the-location-of-temporary-or-transaction-files"><a class="header" href="#moving-the-location-of-temporary-or-transaction-files"><a id="topic11"></a>Moving the Location of Temporary or Transaction Files</a></h2>
<p>You can move temporary or transaction files to a specific tablespace to improve database performance when running queries, creating backups, and to store data more sequentially.</p>
<p>The SynxDB server configuration parameter <code>temp_tablespaces</code> controls the location for both temporary tables and temporary spill files for hash aggregate and hash join queries. Temporary files for purposes such as sorting large data sets are also created in these tablespaces.</p>
<p><code>temp_tablespaces</code> specifies tablespaces in which to create temporary objects (temp tables and indexes on temp tables) when a <code>CREATE</code> command does not explicitly specify a tablespace.</p>
<p>Also note the following information about temporary or transaction files:</p>
<ul>
<li>You can dedicate only one tablespace for temporary or transaction files, although you can use the same tablespace to store other types of files.</li>
<li>You cannot drop a tablespace if it used by temporary files.</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../admin_guide/ddl/ddl-database.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../admin_guide/ddl/ddl-schema.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../admin_guide/ddl/ddl-database.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../admin_guide/ddl/ddl-schema.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
