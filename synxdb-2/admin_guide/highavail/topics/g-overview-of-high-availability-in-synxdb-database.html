<!DOCTYPE HTML>
<html lang="en" class="ayu sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Overview of SynxDB High Availability - SynxDB 2 Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../../favicon.svg">
        <link rel="shortcut icon" href="../../../favicon.png">
        <link rel="stylesheet" href="../../../css/variables.css">
        <link rel="stylesheet" href="../../../css/general.css">
        <link rel="stylesheet" href="../../../css/chrome.css">
        <link rel="stylesheet" href="../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../highlight.css">
        <link rel="stylesheet" href="../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">SynxDB 2 Documentation</h1>

                    <div class="right-buttons">
                        <a href="../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                        &nbsp;&nbsp;&nbsp;&nbsp;
                        <a href="https://www.synxdata.com/"><img id="fa fa-print" src="../../../SYNX-Text-and-Circular-Logo-142x28-White-text-Black-background.png" alt="Synx Data Labs Logo"/></a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="overview-of-synxdb-high-availability"><a class="header" href="#overview-of-synxdb-high-availability">Overview of SynxDB High Availability</a></h1>
<p>A SynxDB system can be made highly available by providing a fault-tolerant hardware platform, by enabling SynxDB high-availability features, and by performing regular monitoring and maintenance procedures to ensure the health of all system components.</p>
<p>Hardware components will eventually fail, whether due to normal wear or an unexpected circumstance. Loss of power can lead to temporarily unavailable components. A system can be made highly available by providing redundant standbys for components that can fail so that services can continue uninterrupted when a failure does occur. In some cases, the cost of redundancy is higher than users’ tolerance for interruption in service. When this is the case, the goal is to ensure that full service is able to be restored, and can be restored within an expected timeframe.</p>
<p>With SynxDB, fault tolerance and data availability is achieved with:</p>
<ul>
<li><a href="#raid">Hardware level RAID storage protection</a></li>
<li><a href="#checksums">Data storage checksums</a></li>
<li><a href="#segment_mirroring">SynxDB segment mirroring</a></li>
<li><a href="#master_mirroring">Master mirroring</a></li>
<li><a href="#dual_clusters">Dual clusters</a></li>
<li><a href="#backup_restore">Database backup and restore</a></li>
</ul>
<h2 id="hardware-level-raid"><a class="header" href="#hardware-level-raid"><a id="raid"></a>Hardware level RAID</a></h2>
<p>A best practice SynxDB deployment uses hardware level RAID to provide high performance redundancy for single disk failure without having to go into the database level fault tolerance. This provides a lower level of redundancy at the disk level.</p>
<h2 id="data-storage-checksums"><a class="header" href="#data-storage-checksums"><a id="checksums"></a>Data storage checksums</a></h2>
<p>SynxDB uses checksums to verify that data loaded from disk to memory has not been corrupted on the file system.</p>
<p>SynxDB has two kinds of storage for user data: heap and append-optimized. Both storage models use checksums to verify data read from the file system and, with the default settings, they handle checksum verification errors in a similar way.</p>
<p>SynxDB master and segment database processes update data on pages in the memory they manage. When a memory page is updated and flushed to disk, checksums are computed and saved with the page. When a page is later retrieved from disk, the checksums are verified and the page is only permitted to enter managed memory if the verification succeeds. A failed checksum verification is an indication of corruption in the file system and causes SynxDB to generate an error, cancelling the transaction.</p>
<p>The default checksum settings provide the best level of protection from undetected disk corruption propagating into the database and to mirror segments.</p>
<p>Heap checksum support is enabled by default when the SynxDB cluster is initialized with the <code>gpinitsystem</code> management utility. Although it is strongly discouraged, a cluster can be initialized without heap checksum support by setting the <code>HEAP_CHECKSUM</code> parameter to off in the <code>gpinitsystem</code> cluster configuration file. See <a href="../../../utility_guide/ref/gpinitsystem.html">gpinitsystem</a>.</p>
<p>Once initialized, it is not possible to change heap checksum support for a cluster without reinitializing the system and reloading databases.</p>
<p>You can check the read-only server configuration parameter <a href="../../../ref_guide/config_params/guc-list.html">data_checksums</a> to see if heap checksums are enabled in a cluster:</p>
<pre><code>$ gpconfig -s data_checksums
</code></pre>
<p>When a SynxDB cluster starts up, the <code>gpstart</code> utility checks that heap checksums are consistently enabled or deactivated on the master and all segments. If there are any differences, the cluster fails to start. See <a href="../../../utility_guide/ref/gpstart.html">gpstart</a>.</p>
<p>In cases where it is necessary to ignore heap checksum verification errors so that data can be recovered, setting the <a href="../../../ref_guide/config_params/guc-list.html">ignore_checksum_failure</a> system configuration parameter to on causes SynxDB to issue a warning when a heap checksum verification fails, but the page is then permitted to load into managed memory. If the page is updated and saved to disk, the corrupted data could be replicated to the mirror segment. Because this can lead to data loss, setting <code>ignore_checksum_failure</code> to on should only be done to enable data recovery.</p>
<p>For append-optimized storage, checksum support is one of several storage options set at the time an append-optimized table is created with the <code>CREATE TABLE</code> command. The default storage options are specified in the <code>gp_default_storage_options</code> server configuration parameter. The <code>checksum</code> storage option is activated by default and deactivating it is strongly discouraged.</p>
<p>If you choose to deactivate checksums for an append-optimized table, you can either</p>
<ul>
<li>change the <code>gp_default_storage_options</code> configuration parameter to include <code>checksum=false</code> before creating the table, or</li>
<li>add the <code>checksum=false</code> option to the <code>WITH storage\_options</code> clause of the <code>CREATE TABLE</code> statement.</li>
</ul>
<p>Note that the <code>CREATE TABLE</code> statement allows you to set storage options, including checksums, for individual partition files.</p>
<p>See the <a href="../../../ref_guide/sql_commands/CREATE_TABLE.html">CREATE TABLE</a> command reference and the <a href="../../../ref_guide/config_params/guc-list.html">gp_default_storage_options</a> configuration parameter reference for syntax and examples.</p>
<h2 id="segment-mirroring"><a class="header" href="#segment-mirroring"><a id="segment_mirroring"></a>Segment Mirroring</a></h2>
<p>SynxDB stores data in multiple segment instances, each of which is a SynxDB PostgreSQL instance. The data for each table is spread between the segments based on the distribution policy that is defined for the table in the DDL at the time the table is created. When segment mirroring is enabled, for each segment instance there is a <em>primary</em> and <em>mirror</em> pair. The mirror segment is kept up to date with the primary segment using Write-Ahead Logging (WAL)-based streaming replication. See <a href="g-overview-of-segment-mirroring.html">Overview of Segment Mirroring</a>.</p>
<p>The mirror instance for each segment is usually initialized with the <code>gpinitsystem</code> utility or the <code>gpexpand</code> utility. As a best practice, the mirror runs on a different host than the primary instance to protect from a single machine failure. There are different strategies for assigning mirrors to hosts. When choosing the layout of the primaries and mirrors, it is important to consider the failure scenarios to ensure that processing skew is minimized in the case of a single machine failure.</p>
<h2 id="master-mirroring"><a class="header" href="#master-mirroring"><a id="master_mirroring"></a>Master Mirroring</a></h2>
<p>There are two master instances in a highly available cluster, a <em>primary</em> and a <em>standby</em>. As with segments, the master and standby should be deployed on different hosts so that the cluster can tolerate a single host failure. Clients connect to the primary master and queries can be run only on the primary master. The standby master is kept up to date with the primary master using Write-Ahead Logging (WAL)-based streaming replication. See <a href="g-overview-of-master-mirroring.html">Overview of Master Mirroring</a>.</p>
<p>If the master fails, the administrator runs the <code>gpactivatestandby</code> utility to have the standby master take over as the new primary master. You can configure a virtual IP address for the master and standby so that client programs do not have to switch to a different network address when the current master changes. If the master host fails, the virtual IP address can be swapped to the actual acting master.</p>
<h2 id="dual-clusters"><a class="header" href="#dual-clusters"><a id="dual_clusters"></a>Dual Clusters</a></h2>
<p>An additional level of redundancy can be provided by maintaining two SynxDB clusters, both storing the same data.</p>
<p>Two methods for keeping data synchronized on dual clusters are “dual ETL” and “backup/restore.”</p>
<p>Dual ETL provides a complete standby cluster with the same data as the primary cluster. ETL (extract, transform, and load) refers to the process of cleansing, transforming, validating, and loading incoming data into a data warehouse. With dual ETL, this process is run twice in parallel, once on each cluster, and is validated each time. It also allows data to be queried on both clusters, doubling the query throughput. Applications can take advantage of both clusters and also ensure that the ETL is successful and validated on both clusters.</p>
<p>To maintain a dual cluster with the backup/restore method, create backups of the primary cluster and restore them on the secondary cluster. This method takes longer to synchronize data on the secondary cluster than the dual ETL strategy, but requires less application logic to be developed. Populating a second cluster with backups is ideal in use cases where data modifications and ETL are performed daily or less frequently.</p>
<h2 id="backup-and-restore"><a class="header" href="#backup-and-restore"><a id="backup_restore"></a>Backup and Restore</a></h2>
<p>Making regular backups of the databases is recommended except in cases where the database can be easily regenerated from the source data. Backups should be taken to protect from operational, software, and hardware errors.</p>
<p>Use the <a href="../../../utility_guide/ref/gpbackup.html">gpbackup</a> utility to backup SynxDB databases. <code>gpbackup</code> performs the backup in parallel across segments, so backup performance scales up as hardware is added to the cluster.</p>
<p>When designing a backup strategy, a primary concern is where to store the backup data. The data each segment manages can be backed up on the segment’s local storage, but should not be stored there permanently—the backup reduces disk space available to the segment and, more importantly, a hardware failure could simultaneously destroy the segment’s live data and the backup. After performing a backup, the backup files should be moved from the primary cluster to separate, safe storage. Alternatively, the backup can be made directly to separate storage.</p>
<p>Using a SynxDB storage plugin with the <code>gpbackup</code> and <code>gprestore</code> utilities, you can send a backup to, or retrieve a backup from a remote location or a storage appliance. SynxDB storage plugins support connecting to locations including Amazon Simple Storage Service (Amazon S3) locations and Dell EMC Data Domain storage appliances.</p>
<p>Using the Backup/Restore Storage Plugin API you can create a custom plugin that the <code>gpbackup</code> and <code>gprestore</code> utilities can use to integrate a custom backup storage system with the SynxDB.</p>
<p>For information about using <code>gpbackup</code> and <code>gprestore</code>, see <a href="../../managing/backup-gpbackup.html">Parallel Backup with gpbackup and gprestore</a>.</p>
<ul>
<li>
<p><strong><a href="../../highavail/topics/g-overview-of-segment-mirroring.html">Overview of Segment Mirroring</a></strong></p>
</li>
<li>
<p><strong><a href="../../highavail/topics/g-overview-of-master-mirroring.html">Overview of Master Mirroring</a></strong></p>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../../admin_guide/highavail/topics/g-enabling-high-availability-features.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../../admin_guide/highavail/topics/g-overview-of-segment-mirroring.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../../admin_guide/highavail/topics/g-enabling-high-availability-features.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../../admin_guide/highavail/topics/g-overview-of-segment-mirroring.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../../elasticlunr.min.js"></script>
        <script src="../../../mark.min.js"></script>
        <script src="../../../searcher.js"></script>

        <script src="../../../clipboard.min.js"></script>
        <script src="../../../highlight.js"></script>
        <script src="../../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
