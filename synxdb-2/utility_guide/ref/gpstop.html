<!DOCTYPE HTML>
<html lang="en" class="ayu sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>gpstop - SynxDB 2 Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">SynxDB 2 Documentation</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                        &nbsp;&nbsp;&nbsp;&nbsp;
                        <a href="https://www.synxdata.com/"><img id="fa fa-print" src="../../SYNX-Text-and-Circular-Logo-142x28-White-text-Black-background.png" alt="Synx Data Labs Logo"/></a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="gpstop"><a class="header" href="#gpstop">gpstop</a></h1>
<p>Stops or restarts a SynxDB system.</p>
<h2 id="synopsis"><a class="header" href="#synopsis"><a id="section2"></a>Synopsis</a></h2>
<pre><code>gpstop [-d &lt;master_data_directory&gt;] [-B parallel_processes&gt;] 
       [-M smart | fast | immediate] [-t &lt;timeout_seconds&gt;] [-r] [-y] [-a] 
       [-l &lt;logfile_directory&gt;] [-v | -q]

gpstop -m [-d &lt;master_data_directory&gt;] [-y] [-l &lt;logfile_directory&gt;] [-v | -q]

gpstop -u [-d &lt;master_data_directory&gt;] [-l &lt;logfile_directory&gt;] [-v | -q]
 
gpstop --host &lt;host_namea&gt; [-d &lt;master_data_directory&gt;] [-l &lt;logfile_directory&gt;]
       [-t &lt;timeout_seconds&gt;] [-a] [-v | -q]

gpstop --version 

gpstop -? | -h | --help
</code></pre>
<h2 id="description"><a class="header" href="#description"><a id="section3"></a>Description</a></h2>
<p>The <code>gpstop</code> utility is used to stop the database servers that comprise a SynxDB system. When you stop a SynxDB system, you are actually stopping several <code>postgres</code> database server processes at once (the master and all of the segment instances). The <code>gpstop</code> utility handles the shutdown of the individual instances. Each instance is shutdown in parallel.</p>
<p>The default shutdown mode (<code>-M smart</code>) waits for current client connections to finish before completing the shutdown. If any connections remain open after the timeout period, or if you interrupt with CTRL-C, <code>gpstop</code> lists the open connections and prompts whether to continue waiting for connections to finish, or to perform a fast or immediate shutdown. The default timeout period is 120 seconds and can be changed with the <code>-t timeout\_seconds</code> option.</p>
<p>Specify the <code>-M fast</code> shutdown mode to roll back all in-progress transactions and terminate any connections before shutting down.</p>
<p>With the <code>-u</code> option, the utility uploads changes made to the master <code>pg_hba.conf</code> file or to <em>runtime</em> configuration parameters in the master <code>postgresql.conf</code> file without interruption of service. Note that any active sessions will not pick up the changes until they reconnect to the database.</p>
<h2 id="options"><a class="header" href="#options"><a id="section4"></a>Options</a></h2>
<h3 id="-a"><a class="header" href="#-a">-a</a></h3>
<p>Do not prompt the user for confirmation.</p>
<h3 id="-b-parallel_processes"><a class="header" href="#-b-parallel_processes">-B parallel_processes</a></h3>
<p>The number of segments to stop in parallel. If not specified, the utility will start up to 64 parallel processes depending on how many segment instances it needs to stop.</p>
<h3 id="-d-master_data_directory"><a class="header" href="#-d-master_data_directory">-d master_data_directory</a></h3>
<p>Optional. The master host data directory. If not specified, the value set for <code>$MASTER_DATA_DIRECTORY</code> will be used.</p>
<h3 id="host-host_name"><a class="header" href="#host-host_name">–host host_name</a></h3>
<p>The utility shuts down the SynxDB segment instances on the specified host to allow maintenance on the host. Each primary segment instance on the host is shut down and the associated mirror segment instance is promoted to a primary segment if the mirror segment is on another host. Mirror segment instances on the host are shut down.</p>
<p>The segment instances are not shut down and the utility returns an error in these cases:</p>
<ul>
<li>Segment mirroring is not enabled for the system.</li>
<li>The master or standby master is on the host.</li>
<li>Both a primary segment instance and its mirror are on the host.</li>
</ul>
<p>This option cannot be specified with the <code>-m</code>, <code>-r</code>, <code>-u</code>, or <code>-y</code> options.</p>
<blockquote>
<p><strong>Note</strong> The <code>gprecoverseg</code> utility restores segment instances. Run <code>gprecoverseg</code> commands to start the segments as mirrors and then to return the segments to their preferred role (primary segments).</p>
</blockquote>
<h3 id="-l-logfile_directory"><a class="header" href="#-l-logfile_directory">-l logfile_directory</a></h3>
<p>The directory to write the log file. Defaults to <code>~/gpAdminLogs</code>.</p>
<h3 id="-m"><a class="header" href="#-m">-m</a></h3>
<p>Optional. Shuts down a SynxDB master instance that was started in maintenance mode.</p>
<h3 id="-m-fast"><a class="header" href="#-m-fast">-M fast</a></h3>
<p>Fast shut down. Any transactions in progress are interrupted and rolled back.</p>
<h3 id="-m-immediate"><a class="header" href="#-m-immediate">-M immediate</a></h3>
<p>Immediate shut down. Any transactions in progress are cancelled.</p>
<p>This mode kills all <code>postgres</code> processes without allowing the database server to complete transaction processing or clean up any temporary or in-process work files.</p>
<h3 id="-m-smart"><a class="header" href="#-m-smart">-M smart</a></h3>
<p>Smart shut down. This is the default shutdown mode. <code>gpstop</code> waits for active user connections to disconnect and then proceeds with the shutdown. If any user connections remain open after the timeout period (or if you interrupt by pressing CTRL-C) <code>gpstop</code> lists the open user connections and prompts whether to continue waiting for connections to finish, or to perform a fast or immediate shutdown.</p>
<h3 id="-q"><a class="header" href="#-q">-q</a></h3>
<p>Run in quiet mode. Command output is not displayed on the screen, but is still written to the log file.</p>
<h3 id="-r"><a class="header" href="#-r">-r</a></h3>
<p>Restart after shutdown is complete.</p>
<h3 id="-t-timeout_seconds"><a class="header" href="#-t-timeout_seconds">-t timeout_seconds</a></h3>
<p>Specifies a timeout threshold (in seconds) to wait for a segment instance to shutdown. If a segment instance does not shutdown in the specified number of seconds, <code>gpstop</code> displays a message indicating that one or more segments are still in the process of shutting down and that you cannot restart SynxDB until the segment instance(s) are stopped. This option is useful in situations where <code>gpstop</code> is run and there are very large transactions that need to rollback. These large transactions can take over a minute to rollback and surpass the default timeout period of 120 seconds.</p>
<h3 id="-u"><a class="header" href="#-u">-u</a></h3>
<p>This option reloads the <code>pg_hba.conf</code> files of the master and segments and the runtime parameters of the <code>postgresql.conf</code> files but does not shutdown the SynxDB array. Use this option to make new configuration settings active after editing <code>postgresql.conf</code> or <code>pg_hba.conf</code>. Note that this only applies to configuration parameters that are designated as <em>runtime</em> parameters.</p>
<h3 id="-v"><a class="header" href="#-v">-v</a></h3>
<p>Displays detailed status, progress and error messages output by the utility.</p>
<h3 id="-y"><a class="header" href="#-y">-y</a></h3>
<p>Do not stop the standby master process. The default is to stop the standby master.</p>
<h3 id="----h--help"><a class="header" href="#----h--help">-? | -h | –help</a></h3>
<p>Displays the online help.</p>
<h3 id="version"><a class="header" href="#version">–version</a></h3>
<p>Displays the version of this utility.</p>
<h2 id="examples"><a class="header" href="#examples"><a id="section5"></a>Examples</a></h2>
<p>Stop a SynxDB system in smart mode:</p>
<pre><code>gpstop
</code></pre>
<p>Stop a SynxDB system in fast mode:</p>
<pre><code>gpstop -M fast
</code></pre>
<p>Stop all segment instances and then restart the system:</p>
<pre><code>gpstop -r
</code></pre>
<p>Stop a master instance that was started in maintenance mode:</p>
<pre><code>gpstop -m
</code></pre>
<p>Reload the <code>postgresql.conf</code> and <code>pg_hba.conf</code> files after making configuration changes but do not shutdown the SynxDB array:</p>
<pre><code>gpstop -u
</code></pre>
<h2 id="see-also"><a class="header" href="#see-also"><a id="section6"></a>See Also</a></h2>
<p><a href="gpstart.html">gpstart</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../utility_guide/ref/gpstate.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../utility_guide/ref/pg_config.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../utility_guide/ref/gpstate.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../utility_guide/ref/pg_config.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
